                    Файловый и архивный менеджер FAR
                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                Что нового в Plugin API последней версии
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[!] Важное замечание
[+] Нововведение
[*] Изменения
[-] Исправлена ошибка

---------------------------------------------------------------------------
FAR 1.75 (build 2533) (02.03.2009)
---------------------------------------------------------------------------
Общее
~~~~~
[!] В структуре PluginPanelItem теперь по умолчанию вместо структуры
    WIN32_FIND_DATA используется структура FAR_FIND_DATA. Чтоб вернуть старое
    поведение необходимо определить _FAR_USE_WIN32_FIND_DATA.
[!] PluginAPI приведено к совместимости c x64.
[+] Меню плагинов можно вызывать по F11 из диалогов. Для этого плагин должен
    использовать новый флаг PF_DIALOG и уметь обрабатывать OPEN_DIALOG в
    функции OpenPlugin().
[+] В перечисление FARKEYSEQUENCEFLAGS добавлен флаг KSFLAGS_REG_MULTI_SZ.
[+] Добавлена команда ACTL_REDRAWALL - перерисовка всех фреймов FAR.
[+] В перечисление FarDialogSettings добавлены константы:
     FDIS_DELREMOVESBLOCKS - Del удаляет блоки в строках ввода
     FDIS_MOUSECLICKOUTSIDECLOSESDIALOG - Клик мыши вне диалога закрывает его.
[+] Легализован метод вызова плагина из панели - OPEN_FILEPANEL.
[+] Новая команда MCMD_GETSTATE для ACTL_KEYMACRO, возвращает статус работы
    макродвижка.
[+] В Message длинные поля не усекаются, а автоматически заменяются на элемент
    DI_EDIT, что позволяет прокрутить/скопировать название пути/файла.
[+] Новые клавиши:
     KEY_NUMENTER,
     KEY_NUMDEL,
     KEY_DECIMAL,
     KEY_CAPSLOCK;
     KEY_SCROLLLOCK;
     KEY_NUMLOCK;
     KEY_MSWHEEL_LEFT,
     KEY_MSWHEEL_RIGHT,
     KEY_SLEEP.
[+] Добавлена функция FSF.snprintf.
[+] В структуре WindowInfo для окна помощи поле Name содержит полный путь к
    файлу.
[+] В палитру добавлены новые цвета:
     COL_DIALOGLISTARROWS,
     COL_DIALOGLISTARROWSSELECTED,
     COL_DIALOGCOMBOARROWS,
     COL_DIALOGCOMBOARROWSSELECTED,
     COL_WARNDIALOGLISTARROWS,
     COL_WARNDIALOGLISTARROWSSELECTED,
     COL_WARNDIALOGCOMBOARROWS,
     COL_WARNDIALOGCOMBOARROWSSELECTED,
     COL_MENUARROWS,
     COL_MENUARROWSSELECTED,
     COL_COMMANDLINEUSERSCREEN,
     COL_EDITORSCROLLBAR.
[+] Новые флаги FSF.MkLink:
     FLINK_SYMLINKFILE - символическая ссылка-файл (NT>=6)
     FLINK_SYMLINKDIR  - символическая ссылка-каталог (NT>=6)
     FLINK_SYMLINK переименован в FLINK_JUNCTION.
[*] Параметр функции FSF.DeleteBuffer имеет тип void*.
[*] ACTL_KEYMACRO::MCMD_SAVEALL теперь работает при воспроизведения макроса
    (FARCmds: Теперь при исполнения макроса работает команда "macro:save").
[-] После ACTL_SETCURRENTWINDOW/ACTL_COMMIT не посылался EE_KILLFOCUS.
[-] Некорректный цвет у Message без кнопок с флагом MSG_WARNING.
[-] Некорректная прорисовка экрана после вызова функций Editor и Viewer с
    выставленным флагом ?F_IMMEDIATERETURN.

Редактор
~~~~~~~~
[+] События EE_GOTFOCUS и EE_KILLFOCUS.
[+] Добавлены команды управления позициями навигации в редакторе:
    ECTL_DELETESTACKBOOKMARK и ECTL_GETSTACKBOOKMARKS.
[*] Оптимизация открытия файлов с очень длинными строками в редакторе.
[-] Не посылался EE_CLOSE для "?New file?". Теперь EE_CLOSE посылается всегда,
    если был послан EE_READ (во избежание утечек памяти в плагинах).
[-] После вызова EditorControl(ECTL_SELECT) с установленным значением поля
    BlockStartLine = -1, последующий вызов ECTL_GETINFO так же возвращал -1 в
    поле BlockStartLine.
[-] ECTL_SAVEFILE в EE_READ для существующего файла приводило к неверному
    сообщению об изменение файла извне.
[-] Команда ECTL_GETINFO могла вернуть BlockStartLine = -1.
[-] Исправлены ошибки в ECTL_SELECT:
    - не работало снятие выделения в редакторе по EditorSelect.BlockStartPos=-1;
    - отметка блока снимается всегда, даже если были неправильные параметры;
    - отметка блока снимается всегда, даже если указанной строки нет
      (BlockStartLine больше количества строк в редакторе);
    - если BlockHeight превышал количество строк в редакторе, то EditorControl
      возвращал FALSE, хотя блок успешно выделялся;
    - для BlockWidth, равным -1, получалось так, что для BTYPE_COLUMN "транзакция"
      пометки блока была неполной - это могло приводить к всевозможным проблемам
      с блоками.

Программа просмотра
~~~~~~~~~~~~~~~~~~~
[+] События VE_GOTFOCUS и VE_KILLFOCUS.
[+] Добавлена команда VCTL_SETMODE.
[*] Член структуры ViewerMode.TypeWrap переименован в ViewerMode.WordWrap.
[-] Закрытие панели быстрого просмотра на папке вызывало VE_CLOSE без VE_READ.

Диалоги
~~~~~~~
[!] Диалоги с флагом FDLG_SMALLDIALOG теперь отрисовываются с тенью. Чтобы запретить
    рисовать тень, укажите флаг FDLG_NODRAWSHADOW.
[+] Новая экспортируемая функция для плагинов ProcessDialogEvent - обработка
    поступающих в диалог событий.
[+] Добавлен флаг DIF_NOAUTOCOMPLETE, позволяющий отключать автодополнение для
    строк ввода в диалогах.
[+] Новый флаг DIF_NOTCVTUSERCONTROL - не конвертировать символы виртуального
    буфера элемента DI_USERCONTROL.
[+] Для элемента DI_VTEXT добавлена обработка флагов DIF_CENTERGROUP,
    DIF_SEPARATOR, DIF_SEPARATOR2, DIF_SHOWAMPERSAND.
[+] При открытом DI_COMBOBOX в диалоговую процедуру могут посылаться события
    DN_KEY или DN_MOUSEEVENT. Управлять этим поведением можно с помощью
    сообщений DM_SETCOMBOBOXEVENT и DM_GETCOMBOBOXEVENT.
[+] Добавлены команды DM_GETEDITPOSITION и DM_SETEDITPOSITION - управление
    позицией строки в строках ввода в диалогах.
[*] Для диалогов с установленным флагом FDLG_SMALLDIALOG отображается тень.
[*] В диалогах сразу после DN_INITDIALOG приходит DN_GOTFOCUS для того
    элемента, у которого поле Focus=1.
[-] Неправильная ширина DIF_SEPARATOR для диалогов без рамки.
[-] DM_LISTGETCURPOS возвращал неправильное значение после открытия
    комбинированного списка и навигации по нему с последующим отказом
    от выбора (нажали Esc).
[-] Для элементов типа DI_LISTBOX в диалоговую процедуру не поступали события
    DN_MOUSECLICK, отличные от FROM_LEFT_1ST_BUTTON_PRESSED.
[-] Когда в комбинированном списке применялись горячие клавиши, то в строку
    редактирования также попадал символ '&'.
[-] В обработчике DefDlgProc для события DN_BTNCLICK не учитывался флаг
    DIF_BTNNOCLOSE.
[-] Некорректная отрисовка элемента DI_TEXT для сочетания условий:
    DIF_CENTERTEXT + DIF_SEPARATOR + X1 не равен "-1".
[-] Если плагин для списка отключал реакцию слежения за курсором мыши
    (LMRT_NEVER), то в диалоговую процедуру не приходило событие DN_MOUSECLICK
    для двойного клика мыши.
[-] Некорректная отрисовка диалога после закрытия в случае, если фокусным
    элементом был комбинированный список.
[-] Некорректные возвращаемые значения у DM_LISTADDSTR и DM_LISTINSERT.
[-] Исправлена ширину DIF_SEPARATOR для диалогов без рамки.
[-] Комбинированный список, открытый по горячей клавише, при закрытии получал
    DN_EDITCHANGE с параметрами предыдущего фокусного элемента.

Меню
~~~~
[+] Добавлены флаги FMENU_TRUNCPATH, FMENU_TRUNCSTR, FMENU_TRUNCSTREND.
[-] Не освобождалась память для пункта меню с выставленным флагом
    MIF_USETEXTPTR.

Панели
~~~~~~
[+] В структуру PanelInfo добавлен флаг PFLAGS_PANELLEFT.
[+] События FE_GOTFOCUS и FE_KILLFOCUS.
[+] Новая команда FCTL_GETUSERSCREEN - отображение буфера пользовательского
    экрана FAR. Теперь плагины могут эмулировать запуск программ, используя
    FCTL_GETUSERSCREEN и FCTL_SETUSERSCREEN.
[-] При использовании FCTL_SETUSERSCREEN терялась последняя строка экрана.
[-] Переполнение массива при использовании FCTL_GET[ANOTHER]PANEL[SHORT]INFO .
[-] Для элемента ".." в PluginPanelItem заполнялись только поля
    FindData.dwFileAttributes и FindData.cFileName, остальные элементы
    структуры обнулялись.
[-] Неправильно вычислялся текущий каталог на панели плагина с OPIF_REALNAMES.


---------------------------------------------------------------------------
FAR 1.70 (build 2087) (29.03.2006)
---------------------------------------------------------------------------
Редактор
~~~~~~~~
[*] Теперь плагин в ProcessEditorInput получает клавиатурные события
    как при записи, так и при воспроизведении макропоследовательности.
    Ранее клавиатурные события приходили только во время записи.
[+] Константа FARMACRO_KEY_EVENT определяет тип входного сообщения
    структуры INPUT_RECORD, которое передается в ProcessEditorInput во
    время исполнения макрокоманды. Элемент Event содержит структуру
    KEY_EVENT_RECORD с информацией о сообщении с клавиатуры.
[*] Частично снято ограничение на приходящие плагину в ProcessEditorInput
    клавиши.
    Плагину не передаются: Ctrl-W, F11, Alt-F9, F12, Ctrl-Tab,
    Ctrl-Shift-Tab, Alt-Ins и Ctrl-Alt-Shift.
    Следующие сочетания клавиш передаются при условии, что:
     Alt-F5  - плагин PrintMan не установлен;
     Alt-F11 - редактор модальный;
     F6      - есть запрет на переключение в программу просмотра
               (при вызове функции Editor не указан флаг EF_ENABLE_F6).
[+] Команда ESPT_SETWORDDIV - позволяет изменить строку символов-разделителей
    слов для текущей копии редактора.
[+] Команда ESPT_GETWORDDIV - позволяет получить строку символов-разделителей
    слов для текущей копии редактора.
[-] При вызове команды ECTL_SAVEFILE FAR не запоминал новое имя файла.
[-] При сохранении файла в редакторе, вызванного из плагина портился
    пользовательский заголовок, переданный в параметре Title функции
    Editor.
[!] Новый флаг ECF_TAB1. Начиная с build 1957 FAR раскрашивает символ табуляции
    на всю длину, на которую расширяется табуляция. Если необходимо, чтобы
    символ табуляции для цветовой области занимал 1 знакоместо, то для элемента
    EditorColor.Color, в дополнении к цвету, необходимо выставить флаг
    ECF_TAB1.
[!] ECTL_GETBOOKMARKS и ECTL_GETINFO можно вызывать в EE_CLOSE.
[-] Некорректное значение EditorInfo.BlockStartLine.
    Например, есть две непустые строки с номерами N и N+1. Курсор стоит
    посредине строки N+1. Выделения нет. Выполняем Shift-Left до тех пор, пока
    курсор не окажется посредине строки N. В этот момент
    EditorInfo.BlockStartLine равно N+1, а не N, как ожидалось.

Диалоги
~~~~~~~
[-] Для пустого DI_LISTBOX сообщение DM_LISTSETTITLES не выводило заголовки
    списка.
[-] Дублирование курсоров после удаления пунктов из списка DI_LISTBOX в
    случае, если курсор стоит не на удаляемом элементе.
[+] Сообщения DM_GETSELECTION и DM_SETSELECTION, позволяющие управлять
    выделением блоков в строках редактирования диалога.
[-] Некорректное центрирование элементов DI_RADIOBUTTON и DI_CHECKBOX
    с выставленным флагом DIF_CENTERGROUP.
[+] Событие DN_DRAWDIALOGDONE - приходит по окончании отрисовки диалога.
[-] При отсутствии в диалоге фокусных элементов курсор не гасился.
[-] Если заголовок диалога начинается с числа, то это число отрезается в
    заголовке окна Фара.
[-] Смена фокуса (нажатие клавиши Tab или Shift-Tab) в диалоге с единственным
    элементом приводила к зависанию FAR.
[+] Поле FarDialogItem.Data для DI_LISTBOX используется как верхний
    заголовок списка (если не выставлен флаг DIF_LISTNOBOX).
[+] Если в диалоге нет рамок (DI_SINGLEBOX, DI_DOUBLEBOX) и элемент DI_LISTBOX
    первый элемент, то в качестве заголовка консоли берется строка
    заголовка списка (DI_LISTBOX).
[*] Сообщение DM_LISTSETMOUSEREACTION теперь позволяет более гибко управлять
    слежением списка за передвижением курсора мыши (перемещение курсора в
    списке). С помощью этого сообщения можно задавать одно из трех состояний:
    1. список будет реагировать на движение мыши только если элемент в фокусе
    2. список будет всегда реагировать на движение мыши
    3. список не будет реагировать на движение мыши
[+] Сообщение DN_LISTHOTKEY. Сообщает обработчику диалога, что пользователь
    для смены пункта в списке (DI_LISTBOX) воспользовался горячими клавишами.
[-] При движении мышью по листу сообщение DN_LISTCHANGE посылалось даже, если
    элемент списка не менялся. т.е. если двигать мышью в пределах одного
    элемента, будут посылаться много DN_LISTCHANGE с номером этого элемента.
[!] Добавлено ограничение, когда ширина и высота элемента диалога не может
    превышать ширину и высоту диалога.
[-] Использование сообщения DM_SETCURSORPOS для строк ввода в процессе
    обработки события DN_INITDIALOG приводило тому, что строка ввода
    рисовалась до отрисовки самого диалога.
[-] Событие DN_EDITCHANGE для комбинированного списка приходило с неверным
    ID элемента.
[-] Неправильно отрисовывался элемент DI_TEXT. Если вывести строку, а потом
    в обработчике диалога вывести строку меньшего размера, то на экране
    оставалась концовка предыдущего текста.

Прочее
~~~~~~
[-] Для несколько идущих подряд вызовов ACTL_POSTKEYSEQUENCE срабатывал
    только первый.
[-] Исправлена ошибка в FSF.TruncStr, приводящая к порче памяти за
    пределами буфера.
[+] Новый флаг FRS_SCANSYMLINK для функции FarRecursiveSearch - при
    обходе дерева каталогов также заходить в символические связи.
[+] Команда ACTL_GETPLUGINMAXREADDATA. Возвращает максимальный размер
    данных, который FAR может считывать из файла перед передачей
    управления плагину в функцию OpenFilePlugin.
[+] Команда ACTL_GETWCHARMODE. Функция возвращает TRUE, если FAR
    работает с консолью в Unicode-режиме и FALSE, если в 8-битном режиме.
[!] Теперь GetReparsePointInfo для сетевых каталогов возвращает ошибку,
    т.к. корректную информацию о содержимом символической связи в этом
    случае получить невозможно.
[*] Т.к. некоторые настройки перенесены в диалог "Настройка диалогов",
    то добавлена команда ACTL_GETDIALOGSETTINGS и, соответственно, изменены
    значения и названия следующих констант:
    FIS_PERSISTENTBLOCKSINEDITCONTROLS -> FDIS_PERSISTENTBLOCKSINEDITCONTROLS
    FIS_HISTORYINDIALOGEDITCONTROLS    -> FDIS_HISTORYINDIALOGEDITCONTROLS
    FIS_AUTOCOMPLETEININPUTLINES       -> FDIS_AUTOCOMPLETEININPUTLINES
[-] FAR возвращал мусор в PanelInfo.SelectedItems[0] для случая, когда
    на панели нет выделенных файлов и курсор стоит на элементе ".."
[*] Все перечисления в plugin.hpp сделаны именованными
[+] Новая команда MCMD_POSTMACROSTRING - передать в FAR макрос в текстовом
    виде (в том виде, как их хранит FAR Manager в реестре)
[*] Уточнение структуры ActlKeyMacro: добавлен член Param.PlainText -
    указатель на строку, содержащую макропоследовательность.
[+] Новый флаг KSFLAGS_NOSENDKEYSTOPLUGINS - не передавать клавиши редакторным
    плагинам (плагинам, экспортирующим функцию ProcessEditorInput)
[-] Преобразование 'Key = FarNameToKey ("AltCtrlБуква") -> FarKeyToName (Key)'
    работало некорректно (возвращается Alt00000, вместо AltCtrlБуква)
[-] FSF.FarRecursiveSearch, не может найти файл если в качестве маски задано
    его короткое имя.
[-] В .lng файле нельзя было ставить пробелы после идентификатора ".Language",
    например ".Language = foo".
[+] Новый флаг FMENU_CHANGECONSOLETITLE для функции Menu.
    Если указан, то FAR изменит заголовок консоли в значение,
    указанное в параметре Title (если Title не пуст).
[+] Логическое дополнение к числовой сортировке:
    команды FCTL_SETNUMERICSORT и FCTL_SETANOTHERNUMERICSORT
    флаг PFLAGS_NUMERICSORT (включен NumericSort на панели) к PanelInfo.Flags
[-] Падение FAR, если в функции FSF.PointToName() параметр Path == NULL
[+] Команда ACTL_GETSHORTWINDOWINFO - безопасный для использования в потоках
    аналог команды ACTL_GETWINDOWINFO.
[-] FCTL_GET[ANOTHER]PANELSHORTINFO нарушали принцип "неприкосновенности" и
    уничтожали данные, полученные предыдущим вызовом FCTL_GET[ANOTHER]PANELINFO
[*] Теперь FE_CLOSE приходит на панель только в случае, если вызов функции
    OpenPlugin нового плагина вернул hPlugin != INVALID_HANDLE_VALUE.
    Если предыдущая панель сообщит, что ее закрыть нельзя - панель нового
    плагина будет закрыта вызовом ClosePlugin.
[-] Падение FAR при использовании FMENU_CHANGECONSOLETITLE.

Программа просмотра
~~~~~~~~~~~~~~~~~~~
[!] Открыто описание API программы просмотра.


---------------------------------------------------------------------------
FAR 1.70 beta 5 (build 1634) (08.04.2003)
---------------------------------------------------------------------------
Общее
~~~~~
[!] Второй параметр у экспортируемой функции SetFindList теперь объявлен
    как const.
[!] Изменилось описание структуры OpenPluginInfo - некоторые члены стали const
[!] Во время вызова ExitFAR плагину недоступны следующие сервисные функции:
    InputBox, Menu, Dialog[Ex], GetMsg, Message, Control, SaveScreen,
    RestoreScreen, GetDirList, Viewer, Editor, CharTable, Text, EditorControl,
    GetPluginDirList, ShowHelp, AdvControl (частично).
    В AdvControl доступны только следующие команды:
    ACTL_GETFARVERSION, ACTL_GETSYSWORDDIV, ACTL_GETCOLOR, ACTL_GETARRAYCOLOR,
    ACTL_GETFARHWND, ACTL_GETSYSTEMSETTINGS, ACTL_GETPANELSETTINGS,
    ACTL_GETINTERFACESETTINGS, ACTL_GETCONFIRMATIONS, ACTL_GETDESCSETTINGS.
[!] Запрещено создание немодального редактора или программы просмотра из
    модального.
[!] Запрещено переключение из модального в другое окно.
[!] Увеличен размер цветовой палитры FAR Manager. Добавлены цвета, уточняющие
    палитру элементов DI_LISTBOX и DI_COMBOBOX.
[!] Константы CONSOLE_* переименованы в FAR_CONSOLE_* (конфликт с константами
    из WinCon.h)
[+] Два новых флага VF_IMMEDIATERETURN и EF_IMMEDIATERETURN, позволяющих
    плагину получать управление сразу же после открытия редактора/программы
    просмотра. Реально редактор/программа просмотра начнёт работать после
    возвращения плагином управления фару. Может быть использовано для открытия
    нескольких редакторов/программ просмотра мгновенно.
[+] VF_DELETEONLYFILEONCLOSE и EF_DELETEONLYFILEONCLOSE - аналоги
    VF_DELETEONCLOSE и EF_DELETEONCLOSE, но удаляется только файл, а папка,
    содержащая его, не удаляется, даже если она пуста.
[*] Уточнения в GCCReadme.txt
[-] Имена таблиц, возвращаемые плагинам через функцию CharTable(), не
    соответствовали именам, которые показывались в списке по Shift-F8.
[-] FAR изменял переданные плагином данные для панели "Информация" (Ctrl-L).
[*] Введен жесткий контроль за координатами окна редактора и встроенной
    программы просмотра (параметры X1,Y1,X2,Y2 функций Editor и Viewer)

Редактор
~~~~~~~~
[+] ESPT_LOCKMODE - плагины могут запретить/отменить запрет изменения
    файла в редакторе.
[+] ECTL_TURNOFFMARKINGBLOCK - сбросить флаг редактора, который
    установлен в течение того времени, когда пользователь осуществляет
    выделение блока.
[+] Новая команда ECTL_DELETEBLOCK - удалить блок в редакторе.
[-] Падение в обработчике ECTL_SETSTRING, если поле
    EditorSetString.StringLength содержало отрицательное значение.

Диалоги
~~~~~~~
[!] Константы COL_DIALOGMENU* заменены на COL_DIALOGLIST*
[!] Изменено сообщение DN_CTLCOLORDLGLIST. Теперь Param1 указывает на
    номер элемента диалога (типа DI_LISTBOX, DI_COMBOBOX или строковый
    редактор c историей ввода). Param2 - указатель на структуру FarListColors,
    описывающую цветовую палитру списка.
[+] Новый флаг LIF_DELETEUSERDATA, который заставляет FAR удалить
    ассоциированные данные при обновлении пункта списка командой
    DM_LISTUPDATE. По умолчанию данные при обновлении не удаляются.
[+] Новый флаг DIF_CENTERTEXT для статических элементов DI_TEXT и DI_VTEXT.
[+] Два новых флага для DialogEx:
    FDLG_NODRAWSHADOW - не рисовать тень диалога
    FDLG_NODRAWPANEL - не рисовать поле диалога
[+] Теперь заголовок элемента DI_LISTBOX описывается цветом
    COL_DIALOGLISTTITLE.
[*] Изменилось поведение при обновлении списка (DM_LISTUPDATE):
    прикрепленные пользовательские данные (DM_LISTSETDATA) пункта списка
    автоматически не удаляются.
[*] DM_SETTEXT (DM_SETTEXTPTR) теперь работают с DI_LISTBOX. Происходит
    обновление текущего элемента списка. Прикрепленные пользовательские
    данные (DM_LISTSETDATA) пункта списка не изменяются.
[*] Если у DI_SINGLEBOX (DI_DOUBLEBOX) координаты X1==X2 или Y1==Y2, то
    рисуется соответствующая линия (вертикальная или горизонтальная)
[*] Если у DI_SINGLEBOX (DI_DOUBLEBOX) указан флаг DIF_SETCOLOR, то
    младший байт позволяет задавать цвет рамки.
[*] При указании флага FDLG_SMALLDIALOG поле диалога теперь отрисовывается.
[*] По умолчанию цвет для индекса COL_DIALOGLISTDISABLED - темно-серый на
    светло-сером.
[-] Некорректное отображение списка DI_LISTBOX с флагом DIF_LISTNOBOX
[-] В списке DI_LISTBOX не обрабатывались горячие клавиши.
[-] В диалоге при активном фокусном списке DI_LISTBOX не обрабатывались
    горячие клавиши.
[-] При получении фокуса ввода неверно отрисовывался элемент DI_EDIT с
    выставленным флагом DIF_SELECTONENTRY.
[-] Некорректно формировался длинный заголовок диалога.
[-] Некорректно обрабатывалось программное переключение (DM_SETCHECK)
    для группы зависимых кнопок (DI_RADIOBUTTON).
[-] Цвет разделительной линии в диалогах не соответствовал цвету рамки.
[-] DM_LISTADDSTR возвращал некорректное значение позиции добавляемого
    пункта в списке.
[-] Неправильно вычислялась верхняя позиция списка при посылки сообщения
    DM_LISTSETCURPOS с FarListPos.TopPos равным -1.
[-] Ctrl-Ins в строках ввода сбрасывал состояние UnChanged.
[-] Не прорисовывался элемент DI_LISTBOX с флагом DIF_LISTNOBOX высотой
    в 1 строку.

Прочее
~~~~~~
[+] FIB_NOAMPERSAND - флаг для InputBox() - не показывать в приглашении
    ввода амперсанд, использовать его для определения горячей клавиши.
[+] Экспортируемая функция PutFiles может возвращать число 2 (успех,
    но позиционировать курсор на файл не нужно).
[+] FCTL_GETPANELSHORTINFO
    Аналогична FCTL_GETPANELINFO, но поля PanelItems и SelectedItems структуры
    PanelInfo не заполнены и равны NULL. Эта команда предназначена для
    получения общей информации о панели без конкретных сведений об элементах
    панели.
[+] FCTL_GETANOTHERPANELSHORTINFO
    Аналогична FCTL_GETPANELSHORTINFO, но получает информацию о пассивной
    панели.
[+] Новая команда FCTL_CHECKPANELSEXIST. Позволяет проверить
    доступность панелей. В режиме, когда FAR запущен с ключами /e или
    /v (в качестве внешнего редактора или программы просмотра),
    панели не создаются.
[+] Функция FSF.MkLink самостоятельно обновляет панели, если не указан
    флаг FLINK_DONOTUPDATEPANEL.
[-] Функция FSF.MkLink некорректно работала при создании символической связи,
    если в качестве источника был полный путь к каталогу.
[+] Новая команда ACTL_SETARRAYCOLOR, позволяющая изменить цветовую
    палитру FAR Manager.
[*] Теперь в случае, когда на панели имеется колонка Owner, содержимое
    этой колонки передается плагинам при передаче массива структур
    PluginPanelItem. Если колонки Owner нет, то, как и раньше, в поле
    Owner передается NULL.
[-] Некорректная отрисовка текущего указателя в меню для случая, когда
    в переданном массиве пунктов меню первым элементом стоял разделитель и
    не был задан текущий элемент (или в качестве текущего элемента был
    сам разделитель).
[-] Конструкция Message(FMSG_ALLINONE,"\nFoobar") приводила к падению FAR
    (первым символом '\n' пытаемся вывести диалог сообщения без заголовка)
[-] Некорректное отсечение длинного заголовка (параметр Title)
    в функции Message.
[-] Функция FSF.ConvertNameToReal неверно работала для текущего каталога.


---------------------------------------------------------------------------
FAR 1.70 beta 4 (build 1282) (13.03.2002)
---------------------------------------------------------------------------
Общее
~~~~~
[!] Вместо FARMANAGERVERSION в функции GetMinFarVersion() можно
    воспользоваться макросом MAKEFARVERSION
[!] Изменилось определение структуры FarDialogItem для того,
    чтобы plugin.hpp можно было использовать с pure C компиляторами.
[!] Изменилось определение структуры FarFindData для того, чтобы
    можно было получать корректное выравнивание при использовании
    любого компилятора.
[!] Все поля структуры CharTableSet кроме TableName имеют тип unsigned char.
[!] Снято ограничение на 13 строк в функции Message.
[!] Формат HelpTopic для меню, диалогов и месагбоксов может быть:
     1. ":Topic"
        вызов главной темы (by FAR)
     2. "Topic"
        вызов локальной темы
     3. "<FullModuleName>Topic"
        вызов темы помощи из папки, где находится модуль "FullModuleName"
     4. "<FullPath>Topic"
        вызов темы помощи из папки "FullPath"
        Здесь "FullPath" путь ДОЛЖЕН заканчиваться символом '\'
     Если для случая 3 и 4 параметр Topic не указан, то будет
     подставлен "Contents"
[+] В HLF-файлах можно указывать размер табуляции, вставив в начало
    файла помощи конструкцию ".Options TabSize=Размер". "Размер" может быть
    от 1 до 16, по умолчанию - 8.
[+] Две новых "клавиши" для колеса мыши - KEY_MSWHEEL_UP/KEY_MSWHEEL_DOWN.
[+] Новый цвет COL_MENUDISABLEDTEXT - недоступный пункт меню.
[+] FMENU_USEEXT, MIF_*, FarMenuItemEx - "расширение" меню.

Панели
~~~~~~
[!] Уточнения в структуре PanelInfo - поле Flags. Также добавлены флаги
    PANELINFOFLAGS.
[+] Дополнительное поле в структуре PluginPanelItem - CRC32.
[+] FCTL_GETCMDLINESELECTION, FCTL_SETCMDLINESELECTION,
    FCTL_GETCMDLINESELECTEDTEXT
[*] GetPluginDirList(): если параметр hPlugin равен INVALID_HANDLE_VALUE,
    то значение параметра PluginNumber игнорируется (используется номер
    плагина, которому принадлежит активная панель).
[-] В ProcessHostFile не передавался флаг OPM_TOPLEVEL в том случае,
    когда это требовалось (нажатие Shift-F3 на архиве в файловой панели).
[-] Плагину в функцию GetFiles() в качестве параметра DestPath передавалось
    имя папки, усеченного до первой точки. Это по поводу:
    "Надоело распаковывать some.foo.rar в папку some\"

Редактор
~~~~~~~~
[!] EditorGetString.StringText и EditorGetString.EditorGetString.StringEOL
    объявлены как const.
[+] Новые флаги VF_ENABLE_F6 (в функции Viewer) и EF_ENABLE_F6 (в функции
    Editor), разрешающие переключение по F6 из программы просмотра и редактора,
    открытых при помощи соответствующих функций.
[+] ECTL_GETBOOKMARKS, struct EditorBookMarks - информация о закладках в
    редакторе (EditorInfo.BookMarkCount - количество закладок, поддерживаемых
    редактором).
[+] Плагины могут при помощи EditorControl/ECTL_SETPARAM менять текущую
    кодировку в редакторе.
[+] EditorInfo.CurState - состояние редактора (дополнительные флаги-ECSTATE_*)
[+] Флаг EF_DELETEONCLOSE. Аналогичен VF_DELETEONCLOSE.
[+] Флаг EF_DISABLEHISTORY для функции Editor - запретить добавление
    имени файла в историю редактирования (Alt-F11). По умолчанию имя
    в историю добавляется.
[*] При создании нового файла также посылается событие EE_READ плагинам.
[*] ECTL_READINPUT: во время исполнения макроса плагину возвращается корректно
    заполненная структура INPUT_RECORD.
[!] Теперь функция Viewer() возвращает FALSE при ошибке открытия и в том
    случае, когда программа просмотра открывается с флагом VF_NONMODAL.
[-] Неверно обрабатывалась команда ECTL_QUIT

Диалоги
~~~~~~~
[!] Изменена логика возвращаемого значения на сообщение DN_BTNCLICK для
    элементов DI_BUTTON. Теперь это:
      Для DI_BUTTON:
        TRUE  - сообщение обработано, дальше не продолжать обработку
                этого сообщения ядром.
        FALSE - продолжить обработку ядром.
      Для остальных элементов:
        TRUE  - разрешить изменение (и соответственно отрисовку того,
                что пользователь ввёл)
        FALSE - запретить изменение.
[!] Удален флаг LIF_PTRDATA - изжил себя как класс (соответственно изменилась
    структура FarListItem)
[!] FarListItem размер текста 128 + DWORD Reserved [3]
[!] Флаг DIF_CENTERGROUP имеет смысл только для следующих элементов:
    DI_BUTTON, DI_CHECKBOX, DI_RADIOBUTTON и DI_TEXT.
[!] DM_GETTEXTLENGTH возвращает размер строки без учета '\0'
[+] Сообщения диалога для работы со списками (DI_LISTBOX и DI_COMBOBOX) -
    DM_LISTSORT, DM_LISTGET, DM_LISTGETCURPOS, DM_LISTSETCURPOS, DM_LISTDELETE,
    DM_LISTADD, DM_LISTUPDATE, DM_LISTINFO, DM_LISTFINDSTRING, DM_LISTINSERT
    DM_LISTSETTITLES, DM_LISTGETTITLES
    и соответствующие им структуры.
[+] DM_RESIZEDIALOG - изменить размеры диалога.
[+] DM_GETCHECK/DM_SETCHECK/DM_SET3STATE/BSTATE_* - работа с состоянием
    элементов DI_RADIOBUTTON/DI_CHECKBOX
[+] DM_EDITUNCHANGEDFLAG - позволяет управлять состоянием "неизменный
    текст" для полей ввода.
[+] Опциональная посылка DN_MOUSEEVENT в обработчик диалога. По умолчанию
    отключена (DN_MOUSEEVENT/DM_SETMOUSEEVENTNOTIFY)
[+] DM_GETITEMPOSITION, DM_SETITEMPOSITION - получение и установка позиции
    и размеров управляющего элемента.
[+] DM_SETCURSORSIZE, DM_GETCURSORSIZE - управление размером курсора для
    строки редактирования в диалоге
[+] DM_GETDROPDOWNOPENED, DM_SETDROPDOWNOPENED - позволяют программно
    открывать и закрывать комбо-боксы и списки истории.
[+] DM_SETHISTORY - позволяет изменить идентификатор списка истории,
    ассоциированного со строкой редактирования.
[+] DN_DRAGGED - информация о процессе перемещения диалога.
[+] DN_RESIZECONSOLE - нотификационное сообщение "Изменились размеры
    консоли".
[+] DIF_SEPARATOR2 - двойная разделительная линия
[+] Если указан флаг DIF_LISTWRAPMODE, то попытка перемещения курсора
    в списке выше первого пункта или ниже последнего будет приводить к
    перемещению соответственно к последнему или к первому пункту.
[+] Флаги диалога DialogEx:
    FDLG_WARNING - задает для диалога цветовую схему "Предупреждение".
    FDLG_SMALLDIALOG - позволяет создавать диалоги с уменьшенным размером
    рамки. Для таких диалогов не рисуется поле диалога, тень, а при отрисовке
    разделительных линий (DIF_SEPARATOR) предполагается нулевой отступ между
    границей диалога и окружающей его двойной рамкой.
[*] DIF_SHOWAMPERSAND также обрабатывается для DI_BUTTON, DI_CHECKBOX,
    DI_RADIOBUTTON
[*] Изменена реакция стандартного обработчика диалога на событие
    DN_MOUSECLICK за пределами диалога. Теперь, если функция диалога не
    обрабатывает событие DN_MOUSECLICK с Param1=-1, то диалог будет закрыт.
[*] Теперь DI_LISTBOX с выставленным флагом DIF_LISTNOBOX и меню с флагом
    LINFO_SHOWNOBOX рисуются без лишних окантовывающих пробелов вокруг
    списка, что автоматически позволяет использовать DI_LISTBOX в
    диалогах, не опасаясь затирания рамки самого диалога пустым местом от
    списка.
[-] После выбора строки из истории в функцию обработки диалога не посылалось
    сообщение DN_EDITCHANGE.
[-] Некорректно работало сообщение DM_SETTEXTLENGTH.
[-] Элемент диалога DI_USERCONTROL некорректно работал с курсором.
[-] Устранено падение FAR Manager, происходившее в случае посылки
    сообщения DM_SETFOCUS в ответ на событие DN_GOTFOCUS.
[-] Некорректно обрабатывался флаг DIF_READONLY.
[-] Неверно рассчитывались координаты элементов DI_TEXT и DI_VTEXT.
[-] Некорректная работа с элементами, имеющими флаг DIF_NOFOCUS.

Прочее
~~~~~~
[!] Изменения в FSF.MkTemp:
    - функция, в отличии от FAR 1.70 beta 3, физически не создает файл
      на диске, только формирует имя.
    - работает с первыми четырьмя символами префикса
[!] Функция FSF.ExpandEnvironmentStr манипулирует строками в OEM-кодировке.
[+] ACTL_GETWINDOWCOUNT,ACTL_GETWINDOWINFO,ACTL_SETCURRENTWINDOW и ACTL_COMMIT,
    struct WindowInfo - манипулирование "окнами" FAR Manager
[+] ACTL_POSTKEYSEQUENCE - поместить последовательность клавиш для
    последующего выполнения (когда FAR Manager получит управление)
[+] ACTL_GETFARHWND - возвращает HWND текущего окна Фара.
[+] ACTL_GET*SETTINGS - команды, позволяющие плагину узнать некоторые
    настройки FAR Manager.
[+] Новый флаг EJECT_LOAD_MEDIA для ACTL_EJECTMEDIA.
[+] Новая FSF-функция MkLink. Умеет создавать хардлинки, симлинки и
    монтировать диски на файловую систему.
[+] Функция FSF.ConvertNameToReal() преобразует относительное имя файлового
    объекта в полное с учетом символических связей (т.н. reparse point в
    Windows 2000) и текущей папки.
[+] Новая функция FSF.GetReparsePointInfo()
    Функция позволяет для указанной символической связи получить информацию
    об источнике -  путь к исходной папке/диску.
    Функция работает только в Windows 2000 и выше.
    В отличие от ConvertNameToReal, применима только для симлинков.
[*] Функция Unquote убирает все двойные кавычки из строки.
[*] Усовершенствование FarRecursiveSearch:
    1. Проверяется правильность параметров.
    2. Теперь обработка папок не зависит от маски файлов.
    3. Маска может быть стандартного фаровского вида (со скобками,
       перечислением и пр.). Может быть несколько масок файлов, разделенных
       запятыми или точкой с запятой, можно указывать маски исключения,
       можно заключать маски в кавычки.
[*] FSF.FarInputRecordToKey: Параметр имеет модификатор "const".
[-] Функция GetMinFarVersion() не вызывалась для плагинов с флагом
    PF_PRELOAD, а также для плагинов, имеющихся в кэше.

[-] Во время исполнения макроса в меню игнорировались значения массива
    BreakKeys, переданных в функцию Menu.

---------------------------------------------------------------------------
FAR 1.70 beta 3 (build 591) (19.04.2001)
---------------------------------------------------------------------------
[!] Plugins.hlp - содержит уточнения в некоторых статьях.
[!] В plugin.hpp в некоторых экспортируемых и сервисных функциях для
    неизменяемых параметров применен модификатор "const". Это дает
    1) дополнительный контроль со стороны компилятора, предотвращающий
       ошибочную модификацию параметров, которые модифицироваться не должны;
    2) облегчение оптимизации кода (как для компилятора, так и для
       программиста) за счёт исключения необходимости учитывать возможные
       изменения данных, переданных в функцию по указателю.
    При перекомпиляции плагинов следите за точностью описания экспортируемых
    функций.
[+] DIF_VAREDIT - "преодоление барьера в 512 байт" - работает с элементами
    DI_EDIT и DI_COMBOBOX
[!] Изменена структура FarListItem (возможность работы с "длинными данными")
[+] Добавлен флаг LIF_PTRDATA - для работы с "длинными данными". Флаг имеет
    значение только для списка элемента DI_COMBOBOX.
[!] Изменены флаги LISTITEMFLAGS (LIF_*) - значения для LIF_SELECTED,
    LIF_CHECKED и LIF_SEPARATOR перенесены в младший байт старшего слова,
    LIF_DISABLE смещен "вниз".
[!] Изменены имена полей структуры FarDialogItemData.
[+] В сообщении DN_MOUSECLICK теперь можно отловить событие DOUBLE_CLICK.
    (MouseEvent.dwEventFlags==DOUBLE_CLICK)
[!] Основательная переделка внутренних кодов клавиш (farkeys.hpp).
[+] ACTL_EJECTMEDIA - извлечь диск из съемного накопителя.
[+] DM_GETTEXTPTR - аналогично DM_GETTEXT, но в качестве параметра Param2
    выступает указатель на строку приемник
[+] DM_SETTEXTPTR - аналогично DM_SETTEXT, но в качестве параметра Param2
    выступает указатель на строку источник
[!] Ctrl-Break управляемый. Раньше диалог закрывался безусловно,
    независимо от того, что вернул обработчик диалога на DM_CLOSE.
[+] Флаг DIF_SHOWAMPERSAND доступен для элементов DI_SINGLEBOX и DI_DOUBLEBOX
[-] Вызов команды ECTL_SETKEYBAR из события редактора EE_READ приводил к
    падению FAR Manager.
[+] ACTL_KEYMACRO:
    struct ActlKeyMacro - интерфейсная часть для ACTL_KEYMACRO
    MCMD_LOADALL     - все макросы из реестра в память FAR`а
    MCMD_SAVEALL     - все макросы из памяти FAR`а в реестр
[-] При использовании DM_SETDLGITEM неверно устанавливался фокус ввода.
[+] DIF_HIDDEN - элемент не видим
[+] DM_SHOWITEM показать/скрыть элемент
[!] Расширен синтаксис функции Message (подробнее см. Plugins.hlp).
[-] Не посылалось событие EE_REDRAW при исполнении Ctrl-P, Ctrl-M в
    редакторе.
[*] Рисование "салазок" перенесено в DefDlgProc, т.е. обработчик получит
    при перемещении диалога 2 раза событие DN_DRAWDIALOG - Param1 = 1 -
    это как раз сигнал на перерисовку "салазок перемещения"
[*] Если функция-обработчик в ответ на DN_DRAWDIALOG вернула FALSE,
    то весь диалог отрисовываться не будет.
[*] Если функция-обработчик в ответ на DN_DRAWDLGITEM вернула FALSE,
    то элемент диалога отрисовываться не будет
[+] FSF.qsortex - в отличии от FSF.qsort передает 3-й параметр в
    функцию сравнения.
    void qsortex(void *base, size_t nelem, size_t width,
           int (__cdecl *fcmp)(void *, void *,void *userparam),
           void *userparam);
[+] Новый флаг для функции Editor EF_CREATENEW - аналог Shift-F4.
[!] FSF.FarRecursiveSearch - добавлен параметр void *param
[+] FAR "знает" 4 предопределенных темы в HLF-файлах:
    Contents - стандартная главная тема;
    Config   - тема, вызываемая по Shift-F1 из меню настроек плагинов;
    Editor   - тема, вызываемая по Shift-F1 из меню плагинов в редакторе;
    Viewer   - тема, вызываемая по Shift-F1 из меню плагинов в программе
               просмотра.
[+] Новый флаг для функции ShowHelp FHELP_USECONTENTS - если требуемая тема
    не найдена, то отобразить тему "Contents".
[*] ACTL_GETFARVERSION возвращает номер версии, а не TRUE/FALSE. В качестве
    параметра Param можно указывать NULL.
[*] ACTL_WAITKEY ждет любую клавишу, если в качестве параметра Param передали
    NULL или -1.
[+] ECTL_SETPARAM - установка параметров:
    - "Размер табуляции" (ESPT_TABSIZE)
    - "Пробелы вместо табуляции" (ESPT_EXPANDTABS)
    - "Автоотступ" (ESPT_AUTOINDENT)
    - "Курсор за пределами строки" (ESPT_CURSORBEYONDEOL)
    - Формат показа кода текущего символа (ESPT_CHARCODEBASE)
[-] Если пользователь пытался отредактировать read-only файл и в появившемся
    диалоге отказывался от редактирования, плагины, обрабатывающие события
    редактора, получали событие EE_CLOSE, которого получать были не должны.
    Исправлено.
[+] Сообщение DM_ADDHISTORY - добавить строку в историю.
[+] Флаг DIF_MANUALADDHISTORY - не добавлять автоматически строку в историю.

---------------------------------------------------------------------------
FAR 1.70 beta 2 (build 321) (16.12.2000)
---------------------------------------------------------------------------
[!] Plugins.hlp - содержит уточнения в некоторых статьях.
[!] Изменения в Param2 для сообщений DM_SETTEXT & DM_GETTEXT.
    Теперь здесь передается указатель на структуру FarDialogItemData.
[-] Хелп не читался под локалью, отличной от 419 (Русской)
[-] Скорректирована логика работы DISABLED элементов в расширенных диалогах.
[+] 6 цветов для DISABLED элементов (в диалогах и предупреждениях)
    см. Headers.c\farcolor.hpp (или Headers.pas\farcolor.pas)
[+] DIF_3STATE - 3-х уровневый CheckBox (включен=1/выключен=0/неопределенно=2)
[!] Для DI_PSWEDIT и DI_FIXEDIT исключена обработка флага DIF_EDITEXPAND.
[+] ACTL_GETCOLOR, ACTL_GETARRAYCOLOR - получение текущих цветовых атрибутов.
[-] Скорректирована логика работы клавиши Enter в расширенных диалогах.
[!] Функция AddEndSlash работает с обоими видами слешей, также происходит
    изменение уже существующего конечного слеша на такой, который встречается
    чаще.
[*] Для преобразования FarDialogItem.Data во внутреннее представление
    используется функция работы с памятью memmove()
    (терялись данные пользователя)
[!] Изменен формат версии - константа plugin.hpp::FARMANAGERVERSION имеет
    следующий формат:
       HIWORD:         = NNN - # build
       LOWORD:  HIBYTE =   1 - version Hi
                LOBYTE =  70 - version Lo


---------------------------------------------------------------------------
FAR 1.70 beta 1 (272) (21.11.2000)
---------------------------------------------------------------------------
[!] Новые/измененные заголовочные файлы:
       farcolor.hpp  - индексы цветовых атрибутов
       farkeys.hpp   - коды внутренних клавиш FAR Manager
       fmt.hpp       - перемещен из MultiArc
[!] Выравнивание = 2.
[+] "Стандартные функции" - для уменьшения размера плагина - структура
    FarStandardFunctions
[+] Новая функция экспортируемая плагином - GetMinFarVersion().
[+] URL-активаторы и цветовые атрибуты в HLF-файлах.
[+] Новые стандартные функции:
    AdvControl, ShowHelp, InputBox
[!] Несколько префиксов у плагина, разделенных через ":"
    и передача полной командной строки плагину - PF_FULLCMDLINE
[+] Обработка FCTL_*SORTMODE, FCTL_*SORTORDER
[!] Изменения в структуре PluginStartupInfo
[*] Изменено поведение EE_REDRAW.
[+] Дополнительные поля в структуре KeyBarTitles:
    CtrlShiftTitles, AltShiftTitles,  CtrlAltTitles
[+] Немодальный редактор - флаг EF_NONMODAL
[+] Принудительная смена KeyBar в редакторе - ECTL_SETKEYBAR
[+] Dialog API 1.0 - полноценное решение для создания диалогов:
      DialogEx, SendDlgMessage, DefDlgProc
[+] Новые элементы диалога DI_COMBOBOX, DI_LISTBOX, DI_USERCONTROL
[+] DIF_EDITEXPAND, DIF_DROPDOWNLIST, DIF_USELASTHISTORY, DIF_BTNNOCLOSE,
    DIF_MASKEDIT, DIF_DISABLE
[+] Поля редактирования с фиксированной длиной могут иметь
    маску ввода.
[+] Дополнительное поле в структуре PluginInfo
[+] Структуры: FarListItem, FarList
[+] Интерфейс для Pascal/Delphi


                                     [ FAR manager development group ]
