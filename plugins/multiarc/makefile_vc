!if exists(../make_vc_defs)
!include ../make_vc_defs
!endif

NAME = MultiArc
LINK_OBJS = $(OBJDIR)\MultiArc.obj \
$(OBJDIR)\ArcCfg.obj \
$(OBJDIR)\ArcCmd.obj \
$(OBJDIR)\ArcGet.obj \
$(OBJDIR)\ArcMix.obj \
$(OBJDIR)\ArcPlg.obj \
$(OBJDIR)\ArcProc.obj \
$(OBJDIR)\ArcPut.obj \
$(OBJDIR)\ArcRead.obj \
$(OBJDIR)\ArcReg.obj \
$(OBJDIR)\global.obj

CPP_UNALIGN=1

!include ..\makefile_vc_def_inc

!include ..\makefile_vc_target_inc

ALL: libpcre $(OUTDIR)\Formats fmts 
	@copy /Y Custom.ini $(OUTDIR)\Formats\*.*

FMTLIST=Custom Ace Arc Arj Cab Ha Lzh Rar TarGz Zip

$(RES): multiarcversion.hpp

!ifdef __MAKE__
.PHONY: libpcre $(FMTLIST)
!else
FICTIVE=_fictive_
_fictive_:

!endif

$(OUTDIR)\Formats:
	@if not exist "$@\$(NULL)" mkdir "$@"

fmts: $(FMTLIST)

!include ../makefile_vc_getmode

libpcre: $(FICTIVE)
	$(MAKE) /f makefile_vc_libpcre $(_MDEFS) 

$(FMTLIST): $(FICTIVE)
!ifndef INSTALL
	$(MAKE) /f makefile_vc_fmt $(_MKDO_)FMT=$@ $(_MDEFS)
!else
	$(MAKE) /f makefile_vc_fmt $(_MKDO_)FMT=$@ $(_MDEFS) INSTALL=$(INSTALL)
!endif

