OBJDIR = ./obj.32.gcc
REOBJDIR = \.\/obj\.32\.gcc\/
DLLDIR = ..
DLLNAME = libpluginreg.a
DLLFULLNAME = $(DLLDIR)/$(DLLNAME)
SRCS = pluginreg.cpp

CXX = g++
DLLTOOL = dlltool
RM = rm -f
CP = cp -f
M4 = m4 -P
MV = mv -f
MKDIR = mkdir -p
AR = ar
RANLIB = ranlib
CXXFLAGS = -mno-cygwin -Os -funsigned-char -fomit-frame-pointer -fstrict-aliasing -fno-rtti -fno-exceptions

OBJS = $(patsubst %.cpp,$(OBJDIR)/%.o,$(filter %.cpp,$(SRCS)))

all: $(DLLFULLNAME)

$(OBJDIR)/%.o: %.cpp
	@echo compiling $<
	@-$(MKDIR) $(@D)
	@$(CXX) $(CXXFLAGS) -D UNICODE -D _UNICODE -c -o $@ $<


$(DLLFULLNAME): $(OBJS)
	@echo linking $@
	@-$(MKDIR) $(@D)
	@$(AR) rc $(DLLNAME) $(OBJS)
	@$(RANLIB) $(DLLNAME)
	@$(MV) $(DLLNAME) $(DLLDIR)

$(OBJS): pluginreg.hpp
