#The following variables can be set by the user:
#
#NAME - the name of the plugin (project name|dll name).
#
#EXT - extension of the plugin executable (dll by default).
#
#ADDOUTDIR - you can set it to /dir if the target folder for the plugin
#            is a folder inside the default target folder.
#            This is used in multiarc for building *.fmt.
#
#USERCPP - user defined switches for the compiler (added after the default
#          ones).
#
#USERLIBS - specify additional libs you need in the form -llib
#           (added after the default ones).
#
#USERLIBSFIRST - same as USERLIBS but added before the default libs
#                (libraries order is important for gcc).
#
#SRCS - a list of the *.cpp source files.
#
#DOCS - a list of additional files that need to copied to the target folder.
#

OBJDIR = ./final.32.gcc/obj
REOBJDIR = \.\/final\.32\.gcc\/obj\/
DLLDIR = ./final.32.gcc$(ADDOUTDIR)
COMMON = ../common
COMINC = $(COMMON)/ascii
ifndef EXT
EXT = dll
endif
DLLNAME = $(NAME).$(EXT)
DLLFULLNAME = $(DLLDIR)/$(DLLNAME)
DEF = $(NAME).gcc.def
RES = $(OBJDIR)/$(NAME).res.o

CXX = g++
CC = gcc
DLLTOOL = dlltool
RM = rm -f
CP = cp -f
M4 = m4 -P
MV = mv -f
MKDIR = mkdir -p
WINDRES = windres
AR = ar
RANLIB = ranlib
CXXFLAGS = -I $(COMMON) -I $(COMINC) -Wall -Os -funsigned-char -fomit-frame-pointer -fstrict-aliasing -fno-rtti -fno-exceptions $(USERCPP)
CCFLAGS = -I $(COMMON) -I $(COMINC) -Wall -Os -funsigned-char -fomit-frame-pointer -fstrict-aliasing -fno-exceptions $(USERCPP)
LNKFLAGS = -mdll -s -nostartfiles -nodefaultlibs -lgcc $(USERLIBSFIRST) -L $(COMMON) -lCRT -luser32 -lkernel32 -ladvapi32 -lshell32 $(USERLIBS)

OBJS = $(patsubst %.cpp,$(OBJDIR)/%.o,$(filter %.cpp,$(SRCS))) $(RES)
DEPS = $(patsubst %.cpp,$(OBJDIR)/%.d,$(filter %.cpp,$(SRCS)))
MAP = $(patsubst %.$(EXT),%.map,$(DLLFULLNAME))
