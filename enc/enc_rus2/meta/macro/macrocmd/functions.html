<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>

<head>
<title>Функции - Макросы</title>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
<link rel="stylesheet" type="text/css" href="../../../styles/styles.css">
</head>

<body>

<h1>Функции</h1>
<div class="navbar">
<a href="../../index.html">главная</a> |
<a href="../index.html">Макросы</a> |
<a href="index.html">Макроязык</a>
</div>

<p>В макропоследовательности допускаются следующие функции:

<table class="cont">
  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Математические функции</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="abs">abs</a></dfn>(N)</td>
    <td class="cont" width="60%">Возвращает абсолютную величину числового аргумента <em>N</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="max">max</a></dfn>(N1,N2)</td>
    <td class="cont" width="60%">Возвращает максимальное значение между двумя числовыми аргументами <em>N1</em> и <em>N2</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="min">min</a></dfn>(N1,N2)</td>
    <td class="cont" width="60%">Возвращает минимальное значение между двумя числовыми аргументами <em>N1</em> и <em>N2</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="mod">mod</a></dfn>(N1,N2)</td>
    <td class="cont" width="60%">Деление <em>N1</em> по модулю <em>N2</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="int">int</a></dfn>(V)</td>
    <td class="cont" width="60%">Приведение значения выражения <em>V</em> к числу.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="float">float</a></dfn>(V)</td>
    <td class="cont" width="60%">Приведение значения выражения <em>V</em> к числу с плавающей точкой.</td>
  </tr>

  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Строковые функции</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="index">index</a></dfn>(S1,S2[,Mode])</td>
    <td class="cont" width="60%">Если подстрока <em>S2</em> содержится в строке <em>S1</em>, то возвращается её позиция, иначе -1.
      <br>Необязательный параметр <em>Mode</em> задаёт режим сравнения: 0 (по умолчанию) - без учёта регистра, 1 - с учётом регистра.
      </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="rindex">rindex</a></dfn>(S1,S2[,Mode])</td>
    <td class="cont" width="60%">Если подстрока <em>S2</em> содержится в строке <em>S1</em>,
      то возвращается её позиция, иначе -1. Поиск ведётся от конца строки <em>S1</em>.
      <br>Необязательный параметр <em>Mode</em> задаёт режим сравнения: 0 (по умолчанию) - без учёта регистра, 1 - с учётом регистра.
      </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">Result=<dfn><a name="replace">replace</a></dfn>(Str,Find,Replace[,Cnt[,Mode]])</td>
    <td class="cont" width="60%">В строке <em>Str</em> заменить подстроку <em>Find</em> на подстроку <em>Replace</em> <em>Cnt</em> раз
      (укажите <em>Cnt</em> меньше или равно 0 или опустите этот параметр для замены всех найденных подстрок).<br>
      Возвращается результат замены.
      <br>Необязательный параметр <em>Mode</em> задаёт режим сравнения: 0 (по умолчанию) - без учёта регистра, 1 - с учётом регистра.<br>
      Замечания:<ul>
      <li>если <em>Find</em> пустая строка, то возвращается <em>Str</em> без преобразований;</li>
      <!-- li>если <em>Cnt</em> не указан или равно нулю, то возвращается <em>Str</em> без преобразований;</li -->
      <li>если <em>Replace</em> пустая строка, то возвращается копия <em>Str</em>, в которой удалены все подстроки <em>Find</em>;</li>
      <li>если <em>Str</em> пустая строка, то возвращается... пустая строка.</li>
      </ul>

      </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="asc">asc</a></dfn>(S)</td>
    <td class="cont" width="60%">Возвращает код символа <em>S</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="chr">chr</a></dfn>(N)</td>
    <td class="cont" width="60%">Возвращает символ, заданный кодом <em>N</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="itoa">itoa</a></dfn>(N[,Radix])</td>
    <td class="cont" width="60%">Конвертирует целое число <em>N</em> в строку.
    Значение <em>Radix</em> определяет базу, которая должна использоваться при
    преобразовании числа <em>N</em>. Допустимые значения <em>Radix</em> от 2 до 36.<br>
    Если параметр <em>Radix</em> не указан, то подразумевается база 10.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="atoi">atoi</a></dfn>(S[,Radix])</td>
    <td class="cont" width="60%">Конвертирует строковое представление строки <em>N</em> в число.
    Значение <em>Radix</em> определяет базу, которая будет использоваться при
    преобразовании строки <em>S</em>. Допустимые значения <em>Radix</em> от 2 до 36.<br>
    Если параметр <em>Radix</em> не указан или равен 0, то функция попытается сама определить в каком виде представлено строковое представление числа.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="len">len</a></dfn>(V)</td>
    <td class="cont" width="60%">Возвращает длину выражения <em>V</em>. Числовое
      значение выражения <em>V</em> приводится к строке, после чего
      вычисляется длина строки.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="string">string</a></dfn>(V)</td>
    <td class="cont" width="60%">Перевод значения выражения <em>V</em> в строку.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="substr">substr</a></dfn>(V,N1[,N2])</td>
    <td class="cont" width="60%">Возвращает подстроку из выражения <em>V</em>
      начиная с позиции <em>N1</em> длинной <em>N2</em>.<br>
      Если параметр <em>N2</em> не указан или равен -1, то вернётся подстрока от позиции <em>N1</em> до конца строки.<br>
      Если параметр <em>N2</em> равен 0, то вернётся пустая строка.<br>
      </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="trim">trim</a></dfn>(V[,N])</td>
    <td class="cont" width="60%">Удаляет все пробельные символы (пробелы, табуляции,
      переводы строк и возвраты каретки) из строки <em>V</em> снаружи (<em>N</em>=0 или не указан), слева (<em>N</em>=1) или справа (<em>N</em>=2).
      </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="xlat">xlat</a></dfn>(S)</td>
    <td class="cont" width="60%">Возвращает транслитерируемую строку<br>
      Функция аналогична макрокоманде $XLat, но используется в
      выражениях. Строковый аргумент <em>S</em> обязателен.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="lcase">lcase</a></dfn>(S)</td>
    <td class="cont" width="60%">Преобразует строку <em>S</em> в нижний регистр.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="ucase">ucase</a></dfn>(S)</td>
    <td class="cont" width="60%">Преобразует строку <em>S</em> в верхний регистр.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="date">date</a></dfn>([format])</td>
    <td class="cont" width="60%">Возвращает текущую дату/время по формату <em>format</em>. Этот формат подобен тому, что выдаёт утилита date (Unix).<br>
      Функция <dfn>date</dfn> поддерживает следующую спецификацию формата даты (подобен формату функции strftime):
      <table class="cont">
        <tr class="cont">
          <th class="cont" width="10%">Формат</th>
          <th class="cont" width="90%">Описание</th>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%%</td>
          <td class="cont" width="90%">символ %</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%a</td>
          <td class="cont" width="90%">Краткое имя дня недели (Sun или Вск)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%A</td>
          <td class="cont" width="90%">Полное имя дня недели (Sunday или Воскресенье)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%b</td>
          <td class="cont" width="90%">Краткое имя месяца (Jan или Янв)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%B</td>
          <td class="cont" width="90%">Полное имя месяца (January или Январь)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%c</td>
          <td class="cont" width="90%">Дата и время в формате WDay Mnt Day HH:MM:SS yyyy (Mon Jan 10 04:11:54 2000 или Пнд Янв 10 04:11:54 2000)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%C</td>
          <td class="cont" width="90%">Столетие как десятичное число (00 - 99). 1992 =&gt; 19</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%d</td>
          <td class="cont" width="90%">Две цифры дня месяца (01 - 31)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%D</td>
          <td class="cont" width="90%">Синоним для %x</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%e</td>
          <td class="cont" width="90%">Синоним для %d, но вместо ведущего нуля будет стоять пробел.</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%h</td>
          <td class="cont" width="90%">Синоним для %b</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%H</td>
          <td class="cont" width="90%">Две цифры часа (00 - 23)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%I</td>
          <td class="cont" width="90%">Две цифры часа (01 - 12)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%j</td>
          <td class="cont" width="90%">Три цифры дня в году (001 - 366)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%k</td>
          <td class="cont" width="90%">Синоним для %H, но вместо ведущего нуля будет стоять пробел.</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%l</td>
          <td class="cont" width="90%">Синоним для %I, но вместо ведущего нуля будет стоять пробел.</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%L</td>
          <td class="cont" width="90%">Триггер, переключающий язык названий
            месяцев и дней недели - английский/локальный.<br>
            FAR запрашивает у системы 2 набора наименований:<br>
            1) английские наименования месяцев и дней недели<br>
            2) наименования, соответствующие настройкам текущего
            пользователя (LOCALE_USER_DEFAULT)<br>
            По умолчанию выставляются английские наименования.</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%m</td>
          <td class="cont" width="90%">Месяц, как десятичное число (1 - 12)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%m0</td>
          <td class="cont" width="90%">Подобно %m, но с ведущим нулём (01 - 12)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%mh</td>
          <td class="cont" width="90%">Одна цифра месяца, как шестнадцатеричное число (1 - C)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%M</td>
          <td class="cont" width="90%">Две цифры минут (00 - 59)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%n</td>
          <td class="cont" width="90%">Подобно переводу строки `\\n'<br>Внимание! В редакторе автоотступ не работает.</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%p</td>
          <td class="cont" width="90%">AM или PM</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%r</td>
          <td class="cont" width="90%">Подобно %I:%M:%S %p</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%R</td>
          <td class="cont" width="90%">Подобно %H:%M</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%S</td>
          <td class="cont" width="90%">Две цифры секунд (00 - 59)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%t</td>
          <td class="cont" width="90%">Подобно символу табуляции `\\t'</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%T</td>
          <td class="cont" width="90%">Синоним %X</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%U</td>
          <td class="cont" width="90%">Две цифры номера недели, где Воскресенье (Sunday) является первым днём недели (00 - 53)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%v</td>
          <td class="cont" width="90%">Дата в формате dd-mmm-yyyy (mmm - в верхнем регистре)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%V</td>
          <td class="cont" width="90%">Неделя года в соответствии с ISO 8601:<br><em>&quot;Если неделя, содержащая 1 Января, имеет &gt;= 4 дней в течение нового года, тогда это неделя 1; в противном случае это самая последняя нумерованная неделя прошлого года (52 или 53)&quot;</em></td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%w</td>
          <td class="cont" width="90%">День недели где 0 - Воскресенье (Sunday) (0 - 6)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%W</td>
          <td class="cont" width="90%">Две цифры номера недели, где Понедельник (Monday) является первым днём недели (00 - 53)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%x</td>
          <td class="cont" width="90%">Дата в формате подобно dd&lt;sep&gt;mm&lt;sep&gt;yyyy (разделитель &lt;sep&gt; зависит от локальных настроек; порядок дня, месяца и года зависит от локальных настроек)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%X</td>
          <td class="cont" width="90%">Время в формате HH&lt;sep&gt;MM&lt;sep&gt;SS (разделитель &lt;sep&gt; зависит от локальных настроек)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%y</td>
          <td class="cont" width="90%">Две цифры года без столетия (00 - 99)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%Y</td>
          <td class="cont" width="90%">Год со столетием (19yy-20yy)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">%Z</td>
          <td class="cont" width="90%">Имя часового пояса или пусто, если часовой пояс не задан</td>
        </tr>
      </table>

      В функции <dfn>date</dfn> допускается применение следующих escape-последовательностей:
      <table class="cont">
        <tr class="cont">
          <th class="cont" width="10%">Формат</th>
          <th class="cont" width="90%">Описание</th>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">\&quot;</td>
          <td class="cont" width="90%">Символ '&quot;'</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">\'</td>
          <td class="cont" width="90%">Символ '''</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">\\</td>
          <td class="cont" width="90%">Символ '\'</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">\n</td>
          <td class="cont" width="90%">Перевод строки `\n'</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">\t</td>
          <td class="cont" width="90%">Символ табуляции `\t'</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">\a</td>
          <td class="cont" width="90%">bell</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">\b</td>
          <td class="cont" width="90%">`\b'</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">\f</td>
          <td class="cont" width="90%">`\f'</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">\v</td>
          <td class="cont" width="90%">`\v'</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">\N<br>\NN<br>\NNN</td>
          <td class="cont" width="90%">8-ричные символы из OEM кодировки</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">\xNN</td>
          <td class="cont" width="90%">16-ричные символы из OEM кодировки</td>
        </tr>
      </table>
      Если аргумент <em>format</em> не указан, то FAR будет использовать форматную строку <nobr><code>&quot;%a %b %d %H:%M:%S %Z %Y&quot;</code></nobr> (см.).
      </td>
  </tr>


  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Файловые функции</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="fsplit">fsplit</a></dfn>(path,N)</td>
    <td class="cont" width="60%">Разбивает путь <em>path</em> на компоненты и возвращает их комбинацию, в
     зависимости от набора флагов <em>N</em>:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Флаги</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000001</td><td class="cont" width="90%">Текущий диск в формате "C:".<br>Для сетевых каталогов - "\\server\share"</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000002</td><td class="cont" width="90%">Путь в формате "\Program Files\Far\"</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000004</td><td class="cont" width="90%">Имя</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000008</td><td class="cont" width="90%">Расширение в формате ".EXT" или пусто, если расширения нет.</td></tr>
       </table>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="fexist">fexist</a></dfn>(S)</td>
    <td class="cont" width="60%">Проверяет существование файла/каталога <em>S</em> (возвращает 0 или 1).<br>
      В параметр <em>S</em> допускается использование символов '*' и '?'. В этом случае функция
      проверяет только первое вхождение файла/каталога.<br>
      Функция не работает с панелями.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="fattr">fattr</a></dfn>(S)</td>
    <td class="cont" width="60%">Возвращает файловые атрибуты файла/каталога <em>S</em>
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Атрибут</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000001</td><td class="cont" width="90%">FILE_ATTRIBUTE_READONLY. Файл только для чтения. Приложения могут читать такой файл, но не могут записывать или удалять его.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000002</td><td class="cont" width="90%">FILE_ATTRIBUTE_HIDDEN. Файл скрыт. Такой файл не включается в обычный листинг каталога.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000004</td><td class="cont" width="90%">FILE_ATTRIBUTE_SYSTEM. Этот файл - часть операционной системы.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000010</td><td class="cont" width="90%">FILE_ATTRIBUTE_DIRECTORY. Это каталог.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000020</td><td class="cont" width="90%">FILE_ATTRIBUTE_ARCHIVE. Это архивный файл. Приложения должны использовать этот флаг для копирования, архивирования или удаления.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000080</td><td class="cont" width="90%">FILE_ATTRIBUTE_NORMAL. У этого файла не установлены другие атрибуты. Это значение корректно только при использовании без остальных флагов.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000100</td><td class="cont" width="90%">FILE_ATTRIBUTE_TEMPORARY. Это временный файл. Приложения должны записывать в такой файл только в крайней необходимости. Большая часть данных файла находится в памяти и не сбрасывается на диск, так как файл будет удалён.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000200</td><td class="cont" width="90%">FILE_ATTRIBUTE_SPARSE_FILE. Файл является разрежённым.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000400</td><td class="cont" width="90%">FILE_ATTRIBUTE_REPARSE_POINT. Каталог является точкой повторной обработки.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000800</td><td class="cont" width="90%">FILE_ATTRIBUTE_COMPRESSED. Файл или каталог сжат. Для файла это означает, что все данные его сжаты, для каталога - что компрессия по умолчанию применяется ко всем его файлам и подкаталогам.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00001000</td><td class="cont" width="90%">FILE_ATTRIBUTE_OFFLINE. Данные файла не доступны непосредственно. Означает, что реальные данные файла были физически перемещены на устройства хранения.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00002000</td><td class="cont" width="90%">FILE_ATTRIBUTE_NOT_CONTENT_INDEXED. Этот файл или каталог не будут индексироваться службой индексирования.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00004000</td><td class="cont" width="90%">FILE_ATTRIBUTE_ENCRYPTED. Файл или каталог зашифрован. Для файла, это означает, что все данные в файле зашифрованы. Для директория, это означает, что шифрование является умолчанием для вновь созданных файлов и подкаталогов.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00010000</td><td class="cont" width="90%">FILE_ATTRIBUTE_VIRTUAL. Этот файл - виртуальный файл.</td></tr>

       </table>
       если файловый объект не существует, функция возвращает -1.<br>
       В параметр <em>S</em> допускается использование символов '*' и '?'. В этом случае функция
       возвращает атрибуты только для первого найденного файла/каталога.<br>
       Функция не работает с панелями.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="fattr">testfolder</a></dfn>(S)</td>
    <td class="cont" width="60%">Тестирует каталог <em>S</em>.<br>
       Возвращает:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Значение</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%"> 2</td><td class="cont" width="90%">нет такого</td></tr>
        <tr class="cont"><td class="cont" width="10%"> 1</td><td class="cont" width="90%">каталог не пустой</td></tr>
        <tr class="cont"><td class="cont" width="10%"> 0</td><td class="cont" width="90%">каталог пустой</td></tr>
        <tr class="cont"><td class="cont" width="10%">-1</td><td class="cont" width="90%">нет доступа</td></tr>
        <tr class="cont"><td class="cont" width="10%">-2</td><td class="cont" width="90%">ошибка (некорректный параметр или внутренние проблемы с выделением памяти)</td></tr>
       </table>
    </td>
  </tr>


  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Панель</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="panel.fexist">panel.fexist</a></dfn>(panelType,S)</td>
    <td class="cont" width="60%">Проверяет существование файла/каталога <em>S</em> из активной (<em>panelType</em>=0) или пассивной (<em>panelType</em>=1) панели.<br>
      В параметр <em>S</em> допускается использование символов '*' и '?'. В этом случае функция
      проверяет только первое вхождение файла/каталога.<br>
      Функция возвращает 0, если такого объекта на панели нет, или индекс элемента (без учёта фильтров)<br>
      Функция работает только с панелями.
     </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="panel.fattr">panel.fattr</a></dfn>(panelType,S)</td>
    <td class="cont" width="60%">Возвращает файловые атрибуты файла/каталога <em>S</em> из активной (<em>panelType</em>=0) или пассивной (<em>panelType</em>=1) панели.<br>
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Атрибут</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000001</td><td class="cont" width="90%">FILE_ATTRIBUTE_READONLY. Файл только для чтения. Приложения могут читать такой файл, но не могут записывать или удалять его.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000002</td><td class="cont" width="90%">FILE_ATTRIBUTE_HIDDEN. Файл скрыт. Такой файл не включается в обычный листинг каталога.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000004</td><td class="cont" width="90%">FILE_ATTRIBUTE_SYSTEM. Этот файл - часть операционной системы.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000010</td><td class="cont" width="90%">FILE_ATTRIBUTE_DIRECTORY. Это каталог.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000020</td><td class="cont" width="90%">FILE_ATTRIBUTE_ARCHIVE. Это архивный файл. Приложения должны использовать этот флаг для копирования, архивирования или удаления.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000080</td><td class="cont" width="90%">FILE_ATTRIBUTE_NORMAL. У этого файла не установлены другие атрибуты. Это значение корректно только при использовании без остальных флагов.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000100</td><td class="cont" width="90%">FILE_ATTRIBUTE_TEMPORARY. Это временный файл. Приложения должны записывать в такой файл только в крайней необходимости. Большая часть данных файла находится в памяти и не сбрасывается на диск, так как файл будет удалён.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000200</td><td class="cont" width="90%">FILE_ATTRIBUTE_SPARSE_FILE. Файл является разрежённым.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000400</td><td class="cont" width="90%">FILE_ATTRIBUTE_REPARSE_POINT. Каталог является точкой повторной обработки.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000800</td><td class="cont" width="90%">FILE_ATTRIBUTE_COMPRESSED. Файл или каталог сжат. Для файла это означает, что все данные его сжаты, для каталога - что компрессия по умолчанию применяется ко всем его файлам и подкаталогам.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00001000</td><td class="cont" width="90%">FILE_ATTRIBUTE_OFFLINE. Данные файла не доступны непосредственно. Означает, что реальные данные файла были физически перемещены на устройства хранения.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00002000</td><td class="cont" width="90%">FILE_ATTRIBUTE_NOT_CONTENT_INDEXED. Этот файл или каталог не будут индексироваться службой индексирования.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00004000</td><td class="cont" width="90%">FILE_ATTRIBUTE_ENCRYPTED. Файл или каталог зашифрован. Для файла, это означает, что все данные в файле зашифрованы. Для директория, это означает, что шифрование является умолчанием для вновь созданных файлов и подкаталогов.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00010000</td><td class="cont" width="90%">FILE_ATTRIBUTE_VIRTUAL. Этот файл - виртуальный файл.</td></tr>

       </table>
       если файловый объект не существует, функция возвращает -1.<br>
       В параметр <em>S</em> допускается использование символов '*' и '?'. В этом случае функция
       возвращает атрибуты только для первого найденного файла/каталога.<br>
       Функция работает только с панелями.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="panelitem"></a><a name="panel.item">panel.item</a></dfn>(panelType,itemIndex,propIndex)</td>
    <td class="cont" width="60%">Возвращает различную информацию для элемента панели <em>itemIndex</em> (начиная с 1)
      из активной (<em>panelType</em>=0) или пассивной (<em>panelType</em>=1) панели. <em>propIndex</em> может быть
      одним из следующих значений:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Значение</th><th class="cont" width="10%">Тип</th><th class="cont" width="80%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Имя файла/каталога</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Короткое имя</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Файловые атрибуты</td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Дата/время создания</td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Дата/время последнего доступа</td></tr>
        <tr class="cont"><td class="cont" width="10%">5</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Дата/время модификации</td></tr>
        <tr class="cont"><td class="cont" width="10%">6</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Размер</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Упакованный размер</td></tr>
        <tr class="cont"><td class="cont" width="10%">8</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">"Выделен?"</td></tr>
        <tr class="cont"><td class="cont" width="10%">9</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Количество линков</td></tr>
        <tr class="cont"><td class="cont" width="10%">10</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">SortGroup</td></tr>
        <tr class="cont"><td class="cont" width="10%">11</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Diz-текст</td></tr>
        <tr class="cont"><td class="cont" width="10%">12</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Владелец</td></tr>
        <tr class="cont"><td class="cont" width="10%">13</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">CRC32</td></tr>
        <tr class="cont"><td class="cont" width="10%">14</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Позиция элемента в процессе чтения файловой системы</td></tr>
       </table>
       Для панели "Дерево папок" возвращается только имя файла (<em>propIndex</em>=0), остальные значения <em>propIndex</em> игнорируются.<br>
       Дата/время возвращается в формате DD.MM.YYYY HH:MM:SS. Разделители и порядок в дате зависят от региональных настроек.<br>
       Для получения данных о текущем файле (под курсором) <em>itemIndex</em> должен быть равен 0.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="panel.setpos">panel.setpos</a></dfn>(panelType,fileName)</td>
    <td class="cont" width="60%">Позиционирует курсор на элемент с именем <em>fileName</em> на активной (<em>panelType</em>=0) или пассивной (<em>panelType</em>=1) панели.<br>
      Возвращает позицию элемента или 0, если такого элемента на панели нет.<br>
      Например, создать каталог с именем, соответствующим текущей дате в формате YYYYMMDD, если каталог существует - позиционировать на него курсор:
      <pre class=code>%dt=date("%Y%m0%d");
$If (fexist(%dt))
  panel.SetPos(0,%dt)
$Else
  F7 $Text %dt Enter
$End</pre>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="panel.setpath">panel.setpath</a></dfn>(panelType,pathName[,fileName])</td>
    <td class="cont" width="60%">На активной (<em>panelType</em>=0) или пассивной (<em>panelType</em>=1) панели выставляет каталог <em>pathName</em> и
      позиционирует курсор на элемент с именем <em>fileName</em> (если указан параметр <em>fileName</em>).<br>
      Возвращает 1 в случае успешной установки каталога и 0, если каталог не существует.<br>
      Например, на активной панели выставить каталог "C:\WINDOWS", на пассивной - "C:\Program Files", активную панель сделать слева и установить курсор на каталог "FAR":
      <pre class=code>$if(APanel.Left) CtrlU $End
panel.SetPath(1,"C:\\WINDOWS")
panel.SetPath(0,"C:\\Program Files","FAR")</pre>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="panel.setposidx">panel.setposidx</a></dfn>(panelType,indexItem[,InSelection])</td>
    <td class="cont" width="60%">Позиционирует курсор на элемент с индексом <em>indexItem</em> на активной (<em>panelType</em>=0) или пассивной (<em>panelType</em>=1) панели.<br>
      Знак параметра <em>indexItem</em> задаёт направление "поиска":<br><ul>
        <li>&lt; 0 - "искать" от конца в начало;
        <li>&gt; 0 - "искать" от начала в конец;
        <li>= 0 - игнорировать переход, просто вернуть текущую позицию</ul>
      Необязательный параметр <em>InSelection</em> задаёт область позиционирования:<ul>
        <li>0 - позиционирование в виртуальном массиве видимых файлов;
        <li>1 - позиционирование в виртуальном массиве отмеченных видимых файлов.</ul><br>
      Функция работает только с видимыми файловыми элементами, с учётом применённых фильтров на панели.<br>
      Возвращает позицию элемента или 0, если такого элемента на панели нет.<br>

    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="panel.select">panel.select</a></dfn>(panelType,Action[,Mode[,Items]])</td>
    <td class="cont" width="60%">Операции с выделением элементов на активной (<em>panelType</em>=0) или пассивной (<em>panelType</em>=1) панели.<br>
      <em>Action</em> может принимать следующие значения:
      <table class="cont">
      <tr class="cont"><th class="cont" width="10%">Значение</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">снять выделение</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">выделить</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">инвертировать выделение</td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="90%">восстановить выделение (аналог Ctrl-M; возвращает количество восстановленных элементов)</td></tr>
      </table>
      Необязательный параметр <em>Mode</em> может принимать следующие значения:
      <table class="cont">
      <tr class="cont"><th class="cont" width="10%">Значение</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0/не указан</td><td class="cont" width="90%">выполнить действие <em>Action</em> для всех элементов, параметр <em>Items</em> игнорируется</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%"><em>Items</em> является числом - индексом элемента панели</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%"><em>Items</em> является строкой - имена файловых объектов (возможны с полными путями)</td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="90%"><em>Items</em> является строкой - файловые маски</td></tr>
      </table>
      Необязательный параметр <em>Items</em> может принимать значения, в зависимости от <em>Action</em> и <em>Mode</em>:<ul>
       <li>для <em>Mode</em> равное 0 - параметр <em>Items</em> игнорируется</li>
       <li>для <em>Mode</em> равное 1:
         <ul>
          <li><em>Items</em> равно 0 или отсутствует - выполнить действие <em>Action</em> для текущего элемента</li>
          <li><em>Items</em> больше 0 - выполнить действие <em>Action</em> для элемента с индексом <em>Items</em></li>
         </ul>
       <li>для <em>Mode</em> равное 2 и 3:
         <ul>
         <li><em>Items</em> равно "" или отсутствует - не выполнять никаких действий</li>
         <li><em>Items</em> отличное от пустой строки - выполнить действие <em>Action</em> для элементов, указанных в <em>Items</em></li>
         </ul>
      </ul>

    <p>Для строковых значений содержимое <em>Items</em> должно подчиняться следующим правилам:
    <ol>
    <li>разделители - функция ожидает смесь разделителей: точка с запятой, запятая или CrLf ("\r\n");
    <li>имена в двойных кавычках.
    </ol>

    <p>Функция возвращает количество элементов, над которыми производилось <em>Action</em><br>
       <table class="cont">
       <tr class="cont"><th class="cont" width="50%">Пример</th><th class="cont" width="50%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="50%">Panel.Select(0,0)</td><td class="cont" width="50%">полное снятие выделения</td></tr>
        <tr class="cont"><td class="cont" width="50%">Panel.Select(0,1)</td><td class="cont" width="50%">выделить все элементы</td></tr>
        <tr class="cont"><td class="cont" width="50%">Panel.Select(0,2)</td><td class="cont" width="50%">инверсия всего</td></tr>
        <tr class="cont"><td class="cont" width="50%">Panel.Select(0,2,1)</td><td class="cont" width="50%">инверсия того, что под курсором</td></tr>
        <tr class="cont"><td class="cont" width="50%">Panel.Select(0,1,1,10)</td><td class="cont" width="50%">"в догонку" выделить 10-й элемент панели</td></tr>
        <tr class="cont"><td class="cont" width="50%">Panel.Select(0,0,3)</td><td class="cont" width="50%">ничего не делать</td></tr>
        <tr class="cont"><td class="cont" width="50%">Panel.Select(0,1,2,clip(0))</td><td class="cont" width="50%">выделить элементы, имена которых содержаться в Буфере Обмена</td></tr>
       </table>
    </td>
  </tr>

  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Управляющие функции</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="iif">iif</a></dfn>(Cond,True,False)</td>
    <td class="cont" width="60%">Условный оператор. Если условие <em>Cond</em> верно,
      то возвращается <em>True</em>-выражение, иначе <em>False</em>-выражение.</td>
  </tr>

  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Среда исполнения</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="env">env</a></dfn>(V)</td>
    <td class="cont" width="60%">Возвращает значение переменной среды V,
      например,<br>
      <pre class=code>$if (Env(&quot;FARLANG&quot;) == &quot;English&quot;) <em>что-то делаем</em> $end</pre></td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">B=<dfn><a name="msave">msave</a></dfn>(S)</td>
    <td class="cont" width="60%">Сохраняет значение глобальной переменной с именем <em>S</em> в область <dfn>Vars</dfn>.<br>
     Числовые значения с плавающей точкой сохраняются в реестре в виде строки.<br>
     В случае неудачи возвращает 0.<br>
     Например, после выполения последовательности <pre class=code>%%GlobalVars="Foo Bar"; %a=msave("%%GlobalVars");</pre>
     в реестре появится значение %%GlobalVars, содержащее "Foo Bar" (REG_SZ).
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">B=<dfn><a name="mload">mload</a></dfn>(S)</td>
    <td class="cont" width="60%">Считать значение глобальной переменной с именем <em>S</em> из реестра (область <dfn>Vars</dfn>).<br>
    Функция вернет 1 - есть такая переменная и она успешно считана в память, 0 - неудача, нет такой переменной в реестре (в этом случае переменная не создается,
     если переменная была в памяти, а из реестра запись удалили, то значение в памяти не изменяется).<br>
     Например, в реестре была переменная "%%GlobalVars" со значением 20 (REG_QWORD). После выполения последовательности
     <pre class=code>%%GlobalVars="Foo Bar"; %a=mload("%%GlobalVars");</pre>
     %%GlobalVars будет равна 20.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="akey">akey</a></dfn>(Mode[,Type])</td>
    <td class="cont" width="60%">Возвращает название или код клавиши, вызвавшей макропоследовательность.
       <em>Mode</em> = 0 - возвращается код клавиши, <em>Mode</em> = 1 - возвращается наименование клавиши.<br>
       <em>Type</em> = 0 - возвращает реально-нажатое сочетание, которым вызывался макрос, <em>Type</em> = 1 - возвращает клавишу, на которую назначен макрос.<br>
       Пример см. в описании <a href="akey.html">$AKey</a></td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="clip">clip</a></dfn>(Cmd[,Val])</td>
    <td class="cont" width="60%">Позволяет производить разнообразные манипуляции с Clipboard в зависимости от команды <em>Cmd</em>:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Cmd</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">Возвращает данные из Clipboard; параметр <em>Val</em> игнорируется; в случае ошибки возвращает 0</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">Поместить строку <em>Val</em> в Clipboard; в случае ошибки возвращает 0</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">Добавить строку <em>Val</em> к Clipboard; в случае ошибки возвращает 0</td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="90%">Копировать Windows Clipboard во внутренний буфер обмена; параметр <em>Val</em> игнорируется; в случае ошибки возвращает 0</td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="90%">Копировать внутренний буфер обмена в Windows Clipboard; параметр <em>Val</em> игнорируется; в случае ошибки возвращает 0</td></tr>
        <tr class="cont"><td class="cont" width="10%">5</td><td class="cont" width="90%">Режимы работы с буфером обмена.<br>
          По умолчанию FAR, в операциях запоминания/вставки данных, работает с Буфером Обмена Windows. Функция 'clip(5)' позволяет в
          пределах одного макроса переключать внутренние механизмы FAR для работы с/без использования Буфера Обмена Windows.<br>
          <em>Val</em> может быть одним из:
          <table class="cont">
            <tr class="cont"><th class="cont" width="10%">Val</th><th class="cont" width="90%">Описание</th></tr>
            <tr class="cont"><td class="cont" width="10%">-1</td><td class="cont" width="90%">Какой буфер обмена сейчас используется</td></tr>
            <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">Переключить работу с буфера обмена OS на внутренний буфер и наоборот (работает как триггер).</td></tr>
            <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">Включить буфер обмена OS</td></tr>
            <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">Включить внутренний буфер обмена</td></tr>
          </table>
          Функция возвращает предыдущее значение: 1 - буфер обмена OS, 2 - внутренний буфер.<br>
          Пример:
<pre class=code>REGEDIT4

;искать тот же файл на другой панели что и на активной
;F5 ShiftEnter CtrlIns - применено чтобы получить имя файла вне зависимости
;пусто/непусто в cmdline и сколько выделено на панели файлов

[HKEY_CURRENT_USER\Software\Far2\KeyMacros\Shell\CtrlAltLeft]
"Sequence"="clip(5) $If (((Bof &amp;&amp; APanel.Root) || !Bof) &amp;&amp; PPanel.Visible)
$If (fexist(PPanel.Path+\"\\\\\"+APanel.Current) == 1) F5 ShiftEnter
CtrlIns Esc Tab Home Alt&lt; ShiftIns Esc $End $End"
"DisableOutput"=dword:00000001

[HKEY_CURRENT_USER\Software\Far2\KeyMacros\Shell\CtrlAltRight]
"Sequence"="clip(5) $If (((Bof &amp;&amp; APanel.Root) || !Bof) &amp;&amp; PPanel.Visible)
$If (fexist(PPanel.Path+\"\\\\\"+APanel.Current) == 1) F5 ShiftEnter CtrlIns
Esc Tab Home Alt&lt; ShiftIns Esc $End $End"
"DisableOutput"=dword:00000001
</pre>
        </td></tr>
       </table>
       Например, поместить в Clipboard список отмеченных файлов в формате CSV (имя и размер):
       <pre class=code>Clip(1,"Name;Size\r\n")
Home
$While(!APanel.Eof)
  $If(!APanel.Folder &amp;&amp; PanelItem(0,0,8))
     Clip(2,PanelItem(0,0,0)+";"+PanelItem(0,0,6)+"\r\n")
  $End
  Down
$End</pre>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="flock">flock</a></dfn>(Nkey,NState)</td>
    <td class="cont" width="60%">Позволяет переключить состояние Lock-клавиш (NumLock, CapsLock и ScrollLock).<br>
    Клавиша <em>Nkey</em>:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Nkey</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">NumLock</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">CapsLock</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">ScrollLock</td></tr>
       </table>
    Состояние <em>NState</em>:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">NState</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">-1</td><td class="cont" width="90%">получить состояние клавиши</td></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">погасить индикатор</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">включить индикатор</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">переключить индикатор в противоположное состояние</td></tr>
       </table>
    Функция капризная (возможно зависание компьютера), поэтому пользоваться ей надо осторожно. Например, макрос, повешенный на CtrlCapsLock (переключение между окнами) должен иметь некую обвязку:
       <pre class=code>CtrlShiftTab
%a=flock(1,-1)&1;
$while((flock(1,-1)&1)==%a)
  sleep(50)
  flock(1,2)
$end</pre>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="sleep">sleep</a></dfn>(N)</td>
    <td class="cont" width="60%">Организация задержки в макросе на <em>N</em> миллисекунд.
     Отрицательное значение задержки считается ошибкой и функция возвращает 0.<br>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="waitkey">waitkey</a></dfn>([N, [T]])</td>
    <td class="cont" width="60%">Ожидает любую клавишу и возвращает её название (<em>T</em>=0) или значение (<em>T</em>=1).
     Если время ожидания <em>N</em> (миллисекунды) истекло, функция возвращает пустую строку (<em>T</em>=0) или 0 (<em>T</em>=1).
     Если параметр <em>N</em> не указан или равен 0, то функция будет бесконечно ждать нажатия клавиши.
     <br>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="key">key</a></dfn>(V)</td>
    <td class="cont" width="60%">Преобразует параметр <em>V</em> в строковый эквивалент названия клавиши.<br>
     Если <em>V</em> строка, то проверяется правильность написания клавиши и она же возвращается,
     если <em>V</em> число, то происходит попытка преобразовать значение в текстовый эквивалент названия клавиши.<br>
     В случае ошибок - возвращается пустая строка.
     <br>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="eval">eval</a></dfn>(S[,Mode])</td>
    <td class="cont" width="60%">"Проиграть" или проверить макропоследовательность.
       <table class="cont">
        <tr class="cont"><th class="cont" width="10%">Mode</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">Выполнить макропоследовательность, заданную строкой <em>S</em>.
          Если <em>S</em> содержит синтаксические ошибки, то макропоследовательность исполняться не будет.
          FAR компилирует последовательность <em>S</em>. Если нет ошибок, то состояние текущего макроса сохраняется
          и начинает выполняться последовательность <em>S</em>. После исполнения <em>S</em> прерванный макрос продолжает работать.
          </td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">Проверить макропоследовательность, заданную строкой <em>S</em>
          и вернуть код ошибки компиляции. Последовательность <em>S</em> исполняться не будет.
          </td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">Выполнить макрос, назначенный на сочетание клавиш <em>S</em>.<br>
          Параметр <em>S</em> задаётся форматом "[Area/]Key". Здесь "<em>Area</em>" - макрообласть, из которой будет исполнен макрос;
          "<em>/</em>" - разделитель;
          "<em>Key</em>" - название клавиши.<br>
          <ul>
          <li>Если "Area/" указан, то будет вызван макрос, назначенный на "Key" только в указанной области "Area". Если "Key" не обнаружен, то функция вернёт значение "-2".
          <li>Если "Area/" не указан, то будет вызван макрос, назначенный на "Key" в текущей области. Если в текущей области "Key" не обнаружен, то будет выполнен макрос, назначенный на "Key" из области Common. Если "Key" не обнаружен, то функция вернёт значение "-2".
          <li>Если в качестве "Area/" указана строка "./", то будет вызван макрос, назначенный на "Key" только в текущей области. Если "Key" не обнаружен, то функция вернёт значение "-2".
          </ul>
          Если "Key" обнаружен, то состояние текущего макроса сохраняется и начинает выполняться макрос, назначенный на сочетание клавиш <em>S</em>.
          После исполнения <em>S</em> прерванный макрос продолжает работать.
          </td></tr>
       </table>

     <br>
     <p>Функция возвращает 0 в случае успешной компиляции последовательности <em>S</em> или код ошибки:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Error</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">-1</td><td class="cont" width="90%">Указаны недопустимые параметры функции</td></tr>
        <tr class="cont"><td class="cont" width="10%">-2</td><td class="cont" width="90%">Для <em>Mode</em>=2 сочетание клавиш <em>S</em> не найдено или макрос заблокирован</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">Неизвестное ключевое слово '<em>ключевое слово</em>'</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">Неизвестная функция '<em>функция</em>'</td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="90%">Неверное количество параметров у функции '<em>функция</em>'</td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="90%">Неожиданное появление $Else</td></tr>
        <tr class="cont"><td class="cont" width="10%">5</td><td class="cont" width="90%">Неожиданное появление $End</td></tr>
        <tr class="cont"><td class="cont" width="10%">6</td><td class="cont" width="90%">Неожиданный конец строки</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="90%">Ожидается '<em>ключевое слово</em>'</td></tr>
        <tr class="cont"><td class="cont" width="10%">8</td><td class="cont" width="90%">Неизвестный шестнадцатеричный управляющий символ</td></tr>
        <tr class="cont"><td class="cont" width="10%">9</td><td class="cont" width="90%">Неправильный управляющий символ</td></tr>
        <tr class="cont"><td class="cont" width="10%">10</td><td class="cont" width="90%">Переменная '<em>переменная</em>' не найдена</td></tr>
        <tr class="cont"><td class="cont" width="10%">11</td><td class="cont" width="90%">Ошибка синтаксиса</td></tr>
        <tr class="cont"><td class="cont" width="10%">12</td><td class="cont" width="90%">Пустая макропоследовательность</td></tr>
       </table>
     <p>Локальные переменные - общие для текущего исполняемого макроса и макропоследовательности, исполняемой функцией <dfn>eval</dfn>.
     <p>Например, необходимо по F10 запускать окно проводника для каталога на активной панели, содержимое командной строки должно сохраняться.<br>
     В области Vars задаём 2 строковых переменных макропроцедуры, описывающие сохранение и восстановление содержимое командной строки:
<pre class=code>
%%CmdSave=$If (!CmdLine.Empty) %Flg_Cmd=1;
          %CmdCurPos=CmdLine.ItemCount-CmdLine.CurPos+1;
          %CmdVal=CmdLine.Value; Esc $End

%%CmdRestore=$If (%Flg_Cmd==1) $Text %CmdVal
          %Flg_Cmd=0; %Num=%CmdCurPos;
          $While (%Num!=0) %Num=%Num-1; CtrlS $End $End
</pre>
     далее на F10 вешаем макрос:
<pre class=code>
$If (APanel.Visible &amp;&amp; (!APanel.Plugin || (!APanel.Bof &amp;&amp;(APanel.OPIFlags &amp; 0x20))))
  Eval(%%CmdSave)
  $If (APanel.Current == "..")
    .
    ShiftEnter
  $Else
    "%SystemRoot%\\explorer.exe /select,"
    $If (Apanel.LFN)
      CtrlN
    $End
    CtrlEnter
    $If (!Apanel.LFN)
      CtrlN
    $End
    Enter
  $End
  Eval(%%CmdRestore)
$End
</pre>
      <p><p>Примеры для <em>Mode</em> = 2:
      <ul>
       <li>вызвать макрос, назначенный на сочетание "CtrlP" из области "Shell"<br><code>eval("Shell/CtrlP",2)</code>
       <li>вызвать макрос, назначенный на сочетание "CtrlP" из текущей макрообласти, если в текущей области "CtrlP" нет, то вызвать макрос из области "Common"<br><code>eval("CtrlP",2)</code>
       <li>вызвать макрос, назначенный на сочетание "CtrlP" только из текущей макрообласти<br><code>eval("./CtrlP",2)</code><br><br>

       <li>вызвать макрос, назначенный на сочетание "Alt/" из области "Shell"<br><code>eval("Shell/Alt/",2)</code>
       <li>вызвать макрос, назначенный на сочетание "Alt/" из текущей макрообласти, если в текущей области "Alt/" нет, то вызвать макрос из области "Common"<br><code>eval("Alt/",2)</code>
       <li>вызвать макрос, назначенный на сочетание "Alt/" только из текущей макрообласти<br><code>eval("./Alt/",2)</code><br><br>
      </ul>

    </td>
  </tr>

  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="mmode">mmode</a></dfn>(Action[,Value])</td>
    <td class="cont" width="60%">Управление параметрами текущего макроса.<br>
      Параметр <em>Action</em>:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Значение</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">позволяет изменять режим перерисовки экрана во время проигрывания макропоследовательности</td></tr>
       </table>
      Параметр <em>Value</em>:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Значение</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">-1</td><td class="cont" width="90%">получить текущее значение</td></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">выключить значение <em>Action</em></td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">включить значение <em>Action</em></td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">переключить значение <em>Action</em> (тригер)</td></tr>
       </table>
       Функция возвращает предыдущее значение.
    </td>
  </tr>

  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Взаимодействие с пользователем</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="msgbox">msgbox</a></dfn>([Title[,Text[,Flags]]])</td>
    <td class="cont" width="60%">
      Показывает сообщение <em>Text</em> с заголовком <em>Title</em>.
      В параметре <em>Text</em> строки разбиваются символом '\n'.<br>
      <em>Flags</em> может быть набором следующих значений:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Flags</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000001</td><td class="cont" width="90%">Используются цвета "Предупреждения" (обычно белые буквы на красном фоне).</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000008</td><td class="cont" width="90%">Показать сообщение двумя строками ниже.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000010</td><td class="cont" width="90%">Использовать для строк сообщения выравнивание влево (по умолчанию строки выводятся по центру).</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00010000</td><td class="cont" width="90%">Выводится кнопка &lt;Ok&gt;</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00020000</td><td class="cont" width="90%">Выводятся кнопки &lt;Ok&gt; и &lt;Cancel&gt;</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00030000</td><td class="cont" width="90%">Выводятся кнопки &lt;Abort&gt;, &lt;Retry&gt; и &lt;Ignore&gt;</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00040000</td><td class="cont" width="90%">Выводятся кнопки &lt;Yes&gt; и &lt;No&gt;</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00050000</td><td class="cont" width="90%">Выводятся кнопки &lt;Yes&gt;, &lt;No&gt; и &lt;Cancel&gt;</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00060000</td><td class="cont" width="90%">Выводятся кнопки &lt;Retry&gt; и &lt;Cancel&gt;</td></tr>
       </table>
       Если параметр <em>Flags</em> равен 0 (или не указан), то выводится стандартный диалог с кнопкой &lt;Ok&gt;<br>
       Функция возвращает 0, если пользователь отменил сообщение или выбранный номер кнопки
       (для первой кнопки - 1, для второй - 2 и так далее).
    </td>
  </tr>

  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="prompt">prompt</a></dfn>("Title"[,"Prompt"[,flags[, "Src"[, "History"]]]])</td>
    <td class="cont" width="60%">Функция позволяет ввести одну строку текста.<br>
      Параметры: <em>Title</em> - заголовок диалога, <em>Prompt</em> - приглашения для ввода, <em>Src</em> - начальное значение строки ввода, <em>History</em> - имя истории ввода<br>
      <em>Flags</em> может быть набором следующих значений (аналогичным константам <a href="../../service_functions/inputbox.html#INPUTBOXFLAGS">FIB_*</a>):
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Flags</th><th class="cont" width="90%">Описание</th></tr>
           <tr class="cont"><td class="cont" width="40%">0x00000001</td><td class="cont" width="60%">даже если строка ввода пуста функция вернёт значение пустое значение.</td></tr>
           <tr class="cont"><td class="cont" width="40%">0x00000002</td><td class="cont" width="60%">используется для ввода пароля - вводимый текст на экране отрисовывается символами <code>'*'</code>.</td></tr>
           <tr class="cont"><td class="cont" width="40%">0x00000004</td><td class="cont" width="60%">после успешного ввода, в результирующем значении <em>S</em> идентификаторы переменных окружения заменяются на их значения, например, если пользователь ввёл '<code>%TEMP%</code>', то <dfn>DestText</dfn> будет содержать '<code>C:\TEMP</code>'.</td></tr>
           <tr class="cont"><td class="cont" width="40%">0x00000008</td><td class="cont" width="60%">не использовать предыдущее значение из истории, оставить строку ввода пустой; актуален, если указан непустой параметр <em>History</em>.</td></tr>
           <tr class="cont"><td class="cont" width="40%">0x00000010</td><td class="cont" width="60%">показать разделительную линию и кнопки [Ok] и [Cancel]. Диалог увеличится на 2 строки.</td></tr>
           <tr class="cont"><td class="cont" width="40%">0x00000020</td><td class="cont" width="60%">не показывать в приглашении ввода амперсанд, использовать его для определения горячей клавиши.</td></tr>
       </table>
       Функция возвращает строку - введённое пользователем значение.<br>
       Например, запросить пароль и вывести его
      <pre class=code>%s=prompt("Password","Input password:",0x02); $Text %s</pre>
    </td>
  </tr>

  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="print">print</a></dfn>(Str)</td>
    <td class="cont" width="60%">Функция предназначена для вставки произвольного текста <em>Str</em> в редактор, командную строку, элементы ввода в диалогах, etc.<br>
      Допускается применение следующих escape-последовательностей:
      <table class="cont">
        <tr class="cont"><th class="cont" width="10%">Формат</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">\&quot;</td><td class="cont" width="90%">Символ '&quot;'</td></tr>
        <tr class="cont"><td class="cont" width="10%">\'</td><td class="cont" width="90%">Символ '''</td></tr>
        <tr class="cont"><td class="cont" width="10%">\\</td><td class="cont" width="90%">Символ '\'</td></tr>
        <tr class="cont"><td class="cont" width="10%">\n</td><td class="cont" width="90%">Переводу строки `\n'</td></tr>
        <tr class="cont"><td class="cont" width="10%">\t</td><td class="cont" width="90%">Табуляции `\t'</td></tr>
        <tr class="cont"><td class="cont" width="10%">\a</td><td class="cont" width="90%">bell</td></tr>
        <tr class="cont"><td class="cont" width="10%">\b</td><td class="cont" width="90%">`\b'</td></tr>
        <tr class="cont"><td class="cont" width="10%">\f</td><td class="cont" width="90%">`\f'</td></tr>
        <tr class="cont"><td class="cont" width="10%">\v</td><td class="cont" width="90%">`\v'</td></tr>
        <tr class="cont"><td class="cont" width="10%">\N<br>\NN<br>\NNN</td><td class="cont" width="90%">8-ричный код символа</td></tr>
        <tr class="cont"><td class="cont" width="10%">\xNN</td><td class="cont" width="90%">16-ричный код символа</td></tr>
      </table>
       Функция возвращает 1.<br>
      Например, создание папки с именем, равным текущей дате:
      <pre class=code>%Folder=date(\"%d.%m0.%Y\");
$If (!panel.fexist(0,%Folder))
  F7
  print(%Folder)
  Enter
$End</pre>
    </td>
  </tr>


  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Элементы управления</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="checkhotkey">checkhotkey</a></dfn>(S[,Pos])</td>
    <td class="cont" width="60%">Функция позволяет проверить и получить позицию элемента (начиная с <em>Pos</em>), который содержит горячую клавишу <em>S</em>.
    Если <em>S</em> - пустая строка, то функция вернёт позицию элемента, который не содержит ни одной горячей клавиши.<br>
    Возвращает: -1 - если функция вызывана не из своей области (MainMenu, Menu, Disks, UserMenu и Dialog), 0 - ничего не найдено, > 0 - если в меню/диалоге/списке присутствует горячая
    клавиша <em>S</em>.<br>
    В диалогах: если текущий элемент ListBox или открытый Combobox (или открытый History), то функция работает с этим элементов.<br>
    <p>Например, в меню вызова плагинов (F11) плагину S&amp;R назначена
    горячая клавиша '7'. Последовательность макрокоманды для редактора:
    <pre class=code>F11 $if (checkhotkey(&quot;7&quot;)) 7 1 $else Esc AltF7 $end</pre>
    вызовет плагин, если хоткей назначен или стандартный диалог
    поиска, если хоткей не назначен.
   </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="gethotkey">gethotkey</a></dfn>([N])</td>
    <td class="cont" width="60%">Возвращает хоткей <em>S</em> для пункта <em>N</em>, если в меню присутствует горячая
      клавиша и текущий &quot;объект&quot; - меню. В противном случае (не меню; нет хоткея; N больше чем количество пунктов меню) возвращает 0.<br>
      Здесь <em>N</em> - позиция в списке от 1 (0 - текущая).
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="menu.getvalue">menu.getvalue</a></dfn>([N])</td>
    <td class="cont" width="60%">Возвращает текст пункта меню для заданной позиции <em>N</em>.<br>
      Если текущий &quot;объект&quot; не меню или позиция <em>N</em> не валидна (меньше 0 или больше количества пунктов в меню), то возвращается пустая строка.<br>
      Если <em>N</em> не указан или равен 0, то действие аналогично применению <a href="states.html#Menu.Value">Menu.Value</a>.<br>
      Позиция меню не меняется.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="menu.itemstatus">menu.itemstatus</a></dfn>([N])</td>
    <td class="cont" width="60%">Возвращает состояние пункта меню с позицией <em>N</em> (текущая позиция - <em>N</em> не указан или равен 0):
       <table class="cont">
        <tr class="cont"><th class="cont" width="40%">Состояние</th><th class="cont" width="60%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="40%">0x00000001</td><td class="cont" width="60%">Признак активности пункта меню. Только один пункт может быть активным.</td></tr>
        <tr class="cont"><td class="cont" width="40%">0x00000002</td><td class="cont" width="60%">Признак отмеченного пункта меню. Перед текстом будет отображаться метка выбора.</td></tr>
        <tr class="cont"><td class="cont" width="40%">0x00000004</td><td class="cont" width="60%">Пункт меню отображается как разделитель.</td></tr>
        <tr class="cont"><td class="cont" width="40%">0x00000008</td><td class="cont" width="60%">Пункт меню недоступен</td></tr>
        <tr class="cont"><td class="cont" width="40%">0x00000010</td><td class="cont" width="60%">Если флаг установлен, то пункт меню доступен в навигации, но не доступен для выбора.</td></tr>
        <tr class="cont"><td class="cont" width="40%">0x00000020</td><td class="cont" width="60%">Если флаг установлен, то пункт меню не выводится на экран.</td></tr>
       </table>
       Функция работает со всеми пунктами меню.<br>
       Если текущий &quot;объект&quot; не меню или позиция <em>N</em> не валидна (меньше 0 или больше количества пунктов в меню), то функция возвращает значение -1 (все биты установлены).
  </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="menu.select">menu.select</a></dfn>(S[,N[,Dir]])</td>
    <td class="cont" width="60%">В меню позиционирует курсор на первый пункт, содержащий подстроку <em>S</em>.
    Поиск подстроки ведётся в зависимости от указанного режима <em>N</em>:
       <table class="cont">
        <tr class="cont"><th class="cont" width="40%">Режим</th><th class="cont" width="60%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="40%">0</td><td class="cont" width="60%">полное совпадение</td></tr>
        <tr class="cont"><td class="cont" width="40%">1</td><td class="cont" width="60%">совпадение с началом строки</td></tr>
        <tr class="cont"><td class="cont" width="40%">2</td><td class="cont" width="60%">совпадение с концом строки</td></tr>
        <tr class="cont"><td class="cont" width="40%">3</td><td class="cont" width="60%">присутствие подстроки <em>S</em> в пункте меню</td></tr>
       </table>
    Поиск регистронезависим. Если такого пункта нет, то ничего не делает.<br>
    Параметр <em>Dir</em> задаёт направление поиска: 0 - от начала в конец списка, 1 - от текущей позиции в начало, 2 - от текущей позиции в конец списка пунктов меню.<br>
    Возвращает: -1=ошибка - функция вызвана не для меню, 0=ошибка при позиционировании (нет пункта или пункт задисаблен), иначе - позицию пункта меню.
    <pre class=code>F11 $if(Menu.Select(&quot;Advanced compare&quot;,0) > 0) Enter $end</pre>
    Если параметр <em>N</em> не указан, подразумевается полное совпадение.
  </td>
  </tr>

  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="dlg.getvalue">dlg.getvalue</a></dfn>(ID,Type)</td>
    <td class="cont" width="60%">Получить различные значения текущего диалога.<br>
      <em>ID</em> - номер элемента диалога (элементы нумеруются с 1; 0 - само диалоговое окно).<br>
      <em>Type</em> - тип получаемой информации, зависит от типа элемента. Для самого диалога (ID=0) допустимы следующие значения:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Type</th><th class="cont" width="10%">Тип Var</th><th class="cont" width="80%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Количество элементов диалога</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">X1</td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Y1</td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">X2</td></tr>
        <tr class="cont"><td class="cont" width="10%">5</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Y2</td></tr>
        <tr class="cont"><td class="cont" width="10%">6</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">ID текущего элемента, имеющего <a href="../../dialogapi/keybfocus.html">клавиатурный фокус ввода</a></td></tr>
       </table>

       Для элементов диалога допустимы:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Type</th><th class="cont" width="10%">Тип Var</th><th class="cont" width="10%">Элемент</th><th class="cont" width="70%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">CheckBox</td><td class="cont" width="70%">Состояние переключателя</td></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">RadioButtons</td><td class="cont" width="70%">Состояние переключателя</td></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">String</td><td class="cont" width="10%">ListBox</td><td class="cont" width="70%">Значение текущего элемента списка</td></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">String</td><td class="cont" width="10%">ComboBox</td><td class="cont" width="70%">Значение текущего элемента списка</td></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">String</td><td class="cont" width="10%">Остальные</td><td class="cont" width="70%">Текстовое значение (поле <a href="../../dialogapi/structures/fardialogitem.html">FarDialogItem.Data</a>)</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Все</td><td class="cont" width="70%"><a href="../../dialogapi/controls/index.html">Тип элемента</a></td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Все</td><td class="cont" width="70%">X1 относительно диалога</td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Все</td><td class="cont" width="70%">Y1 относительно диалога</td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Все</td><td class="cont" width="70%">X2 относительно диалога</td></tr>
        <tr class="cont"><td class="cont" width="10%">5</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Все</td><td class="cont" width="70%">Y2 относительно диалога</td></tr>
        <tr class="cont"><td class="cont" width="10%">6</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Все</td><td class="cont" width="70%">элемент в фокусе?</td></tr>

        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">CheckBox</td><td class="cont" width="70%">Состояние переключателя</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">RadioButtons</td><td class="cont" width="70%">Состояние переключателя</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">String</td><td class="cont" width="10%">ListBox</td><td class="cont" width="70%">Текущая позиция в списке (первый пункт списка = 1)</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">String</td><td class="cont" width="10%">ComboBox</td><td class="cont" width="70%">Текущая позиция в списке (первый пункт списка = 1)</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Остальные</td><td class="cont" width="70%">0</td></tr>

        <tr class="cont"><td class="cont" width="10%">8</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Все</td><td class="cont" width="70%"><a href="../../dialogapi/flags/index.html">Флаги элемента</a></td></tr>
        <tr class="cont"><td class="cont" width="10%">9</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Все</td><td class="cont" width="70%">Флаг, означающий, что данный элемент диалога является "элементом по умолчанию".</td></tr>

        <tr class="cont"><td class="cont" width="10%">10</td><td class="cont" width="10%">String</td><td class="cont" width="10%">Остальные</td><td class="cont" width="70%">Текстовое значение (поле <a href="../../dialogapi/structures/fardialogitem.html">FarDialogItem.Data</a>)</td></tr>
       </table>
       Возвращает -1, если <em>ID</em> больше количества элементов диалога или значение <em>Type</em> не поддерживается.<br>
    </td>
  </tr>

  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Редактор</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="editor.set">editor.set</a></dfn>(Idx,Var)</td>
    <td class="cont" width="60%">Для текущей копии редактора изменить настройки.
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Index</th><th class="cont" width="10%">Тип Var</th><th class="cont" width="80%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Размер табуляции</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Преобразование табуляции</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Постоянные блоки</td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Del удаляет блоки</td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Автоотступ</td></tr>
        <tr class="cont"><td class="cont" width="10%">5</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Автоопределение таблицы символов</td></tr>
        <tr class="cont"><td class="cont" width="10%">6</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">AnsiTableForNewFile</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Курсор за пределами строки</td></tr>
        <tr class="cont"><td class="cont" width="10%">8</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Поведение клавиши BackSpace (TechInfo #13)</td></tr>
        <tr class="cont"><td class="cont" width="10%">9</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Представление кода символа под курсором в статусной строке (TechInfo #32)</td></tr>
        <tr class="cont"><td class="cont" width="10%">10</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Сохранять позицию файла</td></tr>
        <tr class="cont"><td class="cont" width="10%">11</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Сохранять закладки</td></tr>
        <tr class="cont"><td class="cont" width="10%">12</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Символы разделители слов (TechInfo #1)</td></tr>
        <tr class="cont"><td class="cont" width="10%">13</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">EditorF7Rules (TechInfo #18)</td></tr>
        <tr class="cont"><td class="cont" width="10%">14</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">AllowEmptySpaceAfterEof (TechInfo #67)</td></tr>
        <tr class="cont"><td class="cont" width="10%">15</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">ShowScrollBar</td></tr>
        <tr class="cont"><td class="cont" width="10%">16</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">EditOpenedForWrite</td></tr>
        <tr class="cont"><td class="cont" width="10%">17</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">SearchSelFound</td></tr>
        <tr class="cont"><td class="cont" width="10%">18</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">SearchRegexp</td></tr>
        <tr class="cont"><td class="cont" width="10%">19</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">SearchPickUpWord</td></tr>
        <tr class="cont"><td class="cont" width="10%">20</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">ShowWhiteSpace</td></tr>
       </table>
       Значение <em>Var</em> может быть равно -1, в этом случае функция ничего не изменит, а вернёт текущее значение настройки.<br>
       Возвращает предыдущее значение опций или -1, если данные указаны некорректно.<br>
       Например, макрос, перемещающий выделенный фрагмент на одну строку вниз:
       <pre class=code>clip(5) CtrlX %a=Editor.Set(2,1); Down CtrlV %a=Editor.Set(2,%a);</pre>
    </td>
  </tr>

  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="editor.sel">editor.sel</a></dfn>(Action[,Opt])</td>
    <td class="cont" width="60%">Функция позволяет производить некоторые операции с блоками в тексте (в редакторе, в строках ввода в диалогах, в командной строке).
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Action</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">получить параметры текущего блока
        <table class="cont">
          <tr class="cont"><th class="cont" width="10%">Opt</th><th class="cont" width="90%">Описание</th></tr>
          <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">вернуть номер строки начала блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">вернуть номер позиции в строке начала блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">вернуть номер строки конца блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="90%">вернуть номер позиции в строке конца блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="90%">вернуть тип выделенного блока: 0 - блок не выделен, 1 - обычный блок, 2 - вертикальный блок
            (альтернативный вариант - <a href="states.html#editor.state">Editor.State</a>)</td></tr>
        </table>
        </td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">позиционировать курсор внутри текущего блока (при позиционировании курсора состояние блока не изменяется)
        <table class="cont">
          <tr class="cont"><th class="cont" width="10%">Opt</th><th class="cont" width="90%">Описание</th></tr>
          <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">установить курсор в начало отмеченного блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">установить курсор в конец отмеченного блока</td></tr>
        </table>
        </td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">установка позиций блока
        <table class="cont">
          <tr class="cont"><th class="cont" width="10%">Opt</th><th class="cont" width="90%">Описание</th></tr>
          <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">отметить позицию начала блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">отметить позицию конца блока</td></tr>
        </table>
        Позицией начала/конца блока считается текущая позиция курсора. Блок помечается только после указания конечной позиции (<em>Opt</em>=1), с ранее выделенного блока пометка снимается.
        Если позиция начала и конца блока совпадают, то эта операция равносильна снятию пометки блока.
        </td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="90%">установка позиций вертикального блока
        <table class="cont">
          <tr class="cont"><th class="cont" width="10%">Opt</th><th class="cont" width="90%">Описание</th></tr>
          <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">отметить позицию начала вертикального блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">отметить позицию конца вертикального блока</td></tr>
        </table>
        Позицией начала/конца блока считается текущая позиция курсора. Блок помечается только после указания конечной позиции (<em>Opt</em>=1), с ранее выделенного блока пометка снимается.
        Если позиция начала и конца блока совпадают, то эта операция равносильна снятию пометки блока.
        </td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="90%">снять выделение с блока<br>
        Параметр <em>Opt</em> игнорируется.<br>
        Всегда возвращается 1
        </td></tr>
       </table>
       В случае ошибки (в т.ч. функция вызвана не из "редактора") возвращаемое значение равно 0, иначе 1. Для <em>Action</em>=0 возвращается запрошенное значение.
      <br>
      Например, повторим некоторые сочетания клавиш из Turbo-сред (макрос на сочетание Ctrl-K):
      <pre class=code>%k=waitkey(0,1);
$if(%k==B || %k==b || %k==CtrlB)
  editor.sel(2,0)
$else
  $if(%k==K || %k==k || %k==CtrlK)
    editor.sel(2,1)
  $else
    $if((%k==C || %k==c || %k==CtrlC) &amp;&amp; Selected)
      CtrlC
    $else
      $if((%k==Y || %k==y || %k==CtrlY) &amp;&amp; Selected)
        CtrlD
      $else
        eval("F1")
      $end
    $end
  $end
$end</pre>
    </td>
  </tr>

  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="editor.undo">editor.undo</a></dfn>(N)</td>
    <td class="cont" width="60%">Работа с Undo/Redo. Здесь <em>N</em> одно из:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">N</th><th class="cont" width="90%">Описание</th></tr>
       <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">начало блочной операции</td></tr>
       <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">конец блочной операции</td></tr>
       <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">выполнить Undo</td></tr>
       <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="90%">выполнить Redo</td></tr>
       </table>
       Возвращает 1 для успешно выполненной операции или 0 в случае ошибки.<br>
    </td>
  </tr>

  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="editor.settitle">editor.settitle</a></dfn>([Title])</td>
    <td class="cont" width="60%">Установка заголовка в статусной строке редактора.<br>
    Если параметр <em>Title</em> отсутствует или равен пустой строке, то восстанавливается предыдущее значение статусной строки.<br>
    При показе заголовок будет усечён до размера, не затрагивающего служебную информацию (кодировка, позиция, etc.)<br>
    Возвращает 1 для успешно выполненной операции или 0 - редактор не в фокусе.<br>
    </td>
  </tr>

  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="editor.pos">editor.pos</a></dfn>(Op,What[,Where])</td>
    <td class="cont" width="60%">Получение/установка позиций в редакторе.<br>
      Параметр <em>Op</em> задаёт поведение функции: 0 - получить данные, 1 - установить данные.<br>
      Параметр <em>What</em> - над чем выполняется операция:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">What</th><th class="cont" width="90%">Описание</th></tr>
       <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">строка</td></tr>
       <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">положение курсора в строке</td></tr>
       <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="90%">экранная позиция курсора</td></tr>
       <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="90%">новая строка вверху экрана</td></tr>
       <tr class="cont"><td class="cont" width="10%">5</td><td class="cont" width="90%">позиция левой границы окна редактора</td></tr>
       <tr class="cont"><td class="cont" width="10%">6</td><td class="cont" width="90%">режим вставки</td></tr>
       </table>
     Возвращает: -1 - ошибка (например, неверные параметры), для установки 1/0 - успешно/не успешно выполнена установка, для получения - текущее значение.<br>
     Пример (при включённом ScrollLock клавиши Left/Right выполняют скроллинг текста по горизонтали):

     <pre class="code">
[HKEY_CURRENT_USER\Software\far2\KeyMacros\Editor\Right]
"Sequence"="$if(FLock(2,-1) == 1) Editor.Pos(1,5,Editor.Pos(0,5)+1); $else Right $end"
"DisableOutput"=dword:00000001

[HKEY_CURRENT_USER\Software\far2\KeyMacros\Editor\Left]
"Sequence"="$if(FLock(2,-1) == 1) Editor.Pos(1,5,Editor.Pos(0,5)-1); $else Left $end"
"DisableOutput"=dword:00000001
     </pre>
    </td>
  </tr>

  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Работа с закладками</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="bm.add">bm.add</a></dfn>()</td>
    <td class="cont" width="60%">Добавить текущие параметры закладки и обрезать хвост</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="bm.clear">bm.clear</a></dfn>()</td>
    <td class="cont" width="60%">Очистить все закладки</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="bm.del">bm.del</a></dfn>([Idx])</td>
    <td class="cont" width="60%">Удалить закладку с указанным индексом <em>Idx</em> (нумерация начинается с 1). Если параметр <em>Idx</em> не указан или равен 0 - удаляется текущая закладка.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="bm.get">bm.get</a></dfn>(Idx,M)</td>
    <td class="cont" width="60%">Получить параметры закладки с индексом <em>Idx</em> (нумерация начинается с 1), Idx=0 - текущая закладка.<br>
      Параметр <em>M</em> может быть одним из следующих:
       <table class="cont">
        <tr class="cont"><th class="cont" width="40%">Тип</th><th class="cont" width="60%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="40%">0</td><td class="cont" width="60%">координаты строки (начиная с 1)</td></tr>
        <tr class="cont"><td class="cont" width="40%">1</td><td class="cont" width="60%">координаты колонки (начиная с 1)</td></tr>
        <tr class="cont"><td class="cont" width="40%">2</td><td class="cont" width="60%">позиция, соответствующая первому видимому символу текста на экране слева</td></tr>
        <tr class="cont"><td class="cont" width="40%">3</td><td class="cont" width="60%">номер строки, соответствующей первой видимой строке текста на экране</td></tr>
       </table>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="bm.next">bm.next</a></dfn>()</td>
    <td class="cont" width="60%">Перейти на следующую закладку</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="bm.prev">bm.prev</a></dfn>()</td>
    <td class="cont" width="60%">Перейти на предыдущую закладку</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="bm.stat">bm.stat</a></dfn>([M])</td>
    <td class="cont" width="60%">Получить информацию о закладках.<br>
      Параметр <em>M</em> может быть одним из следующих:
       <table class="cont">
        <tr class="cont"><th class="cont" width="40%">Тип</th><th class="cont" width="60%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="40%">0</td><td class="cont" width="60%">текущее количество закладок</td></tr>
       </table>
    </td>
  </tr>
  <tr class="cont"><td class="cont" colspan=2>Пример работы с закладками:<pre class=code>

  </pre></td></tr>

</table>


<h3>Замечания</h3>
<div class=descr>
<ol>
<li>Функции работы с закладками BM.XXX() доступны только в редакторе.
<li>Параметры функций, обозначенные в квадратных скобках можно не указывать. Значение по умолчанию см. в описаниях функций.
<li>Элементы макроязыка невозможно использовать во время <a href="../macrokey/record.html">записи
    макроса</a> стандартным образом. Добавить элементы языка в макрос можно только путём ручной
    правки реестра или путём применения специальных программ/плагинов.</li>
</ol>
</div>

</body>

</html>
