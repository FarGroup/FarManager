<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>_FAR_NO_NAMELESS_UNIONS</title>
<meta http-equiv="Content-Type" Content="text/html; charset=Windows-1251">
<link rel="stylesheet" type="text/css" href="../../styles/styles.css">
<script language="javascript" src='../links.js' type="text/javascript"></script>
</head>

<body>
<h1>_FAR_NO_NAMELESS_UNIONS</h1>
<div class=navbar>
<a href="../index.html">главна€</a> |
<a href="index.html">типы и определени€</a>
</div>


<div class=shortdescr>
Mакроопределение _FAR_NO_NAMELESS_UNIONS определ€ет, будут ли в структуре
<a href="../dialogapi/structures/fardialogitem.html">FarDialogItem</a>
использоватьс€ неименованные объединени€ (union). “акие конструкции
допустимы стандартом C++, но не в ANSI C.

<p>
≈сли <b>не определено</b> макроопределение <dfn>_FAR_NO_NAMELESS_UNIONS</dfn>, структура
<code>FarDialogItem</code> имеет вид, совместимый с FAR 1.65 и FAR 1.70
beta 3 и более ранними. ѕри этом структура
<a href="../dialogapi/structures/fardialogitem.html">FarDialogItem</a>
будет иметь следующий вид:

<pre class="code">
struct FarDialogItem
{
  ...
  union {
    int Selected;
    char *History;
    char *Mask;
    struct FarList *ListItems;
    CHAR_INFO *VBuf;
  <span class="alert3">};</span>
  ...
  union {
    char Data[512];

    struct {
      DWORD PtrFlags;
      int   PtrLength;
      char *PtrData;
      char  PtrTail[1];
    } Ptr;
  <span class="alert3">};</span>
};
</pre>

“аким образом, дл€ обращени€, например, к полю <code>Data</code>
структуры <a href="../dialogapi/structures/fardialogitem.html">FarDialogItem</a>
достаточно будет писать <code>Data</code>, а к полю <code>Selected</code>
- <code>Selected</code>.

<p>≈сли <b>определено</b> макроопределение <dfn>_FAR_NO_NAMELESS_UNIONS</dfn>,
в структуре будут использоватьс€ именованные объединени€. ѕри этом структура
будет совместима с компил€торами ANSI C, но не будет совместима на уровне
исходных текстов с плагинами, написанными дл€ FAR 1.65. —труктура будет иметь
следующий вид:

<pre class="code">
struct FarDialogItem
{
  ...
  union {
    int Selected;
    char *History;
    char *Mask;
    struct FarList *ListItems;
    CHAR_INFO *VBuf;
  <span class="alert3">} Param;</span>
  ...
  union {
    char Data[512];

    struct {
      DWORD PtrFlags;
      int   PtrLength;
      char *PtrData;
      char  PtrTail[1];
    } Ptr;
  <span class="alert3">} Data;</span>
};
</pre>

<p>¬ этом случае дл€ обращени€, например, к полю <code>Data</code> структуры
необходимо будет писать <code>Data.Data</code>, а к полю <code>Selected</code>
- <code>Param.Selected</code>.

<p>“о или иное макроопределение должна быть объ€влено перед
директивой <code>#include "plugin.hpp"</code>:
<pre class="code">
<b>#define _FAR_NO_NAMELESS_UNIONS</b>
#include "plugin.hpp"
</pre>

<p class=note><img src="../../images/warning.gif" alt="¬нимание!" width="10" height="10"> ¬нимание!</p>
<UL class=note><LI>¬ FAR 1.70 beta 4 умолчанием €вл€етс€ вариант,
совместимый со старыми плагинами, то есть, <dfn>_FAR_NO_NAMELESS_UNIONS</dfn> не определено.
ќднако в FAR 1.70 release умолчанием станет новый вариант структуры -
<dfn>_FAR_NO_NAMELESS_UNIONS</dfn>. ѕоэтому если вы хотите, чтобы ваши
плагины были совместимы с версией 1.70 release, вы можете уже сейчас добавить
константу <dfn>_FAR_NO_NAMELESS_UNIONS</dfn> и внести соответствующие
модификации в исходный код ваших плагинов.
</LI></UL>

<div class=see>—мотрите также:</div><div class=seecont>
<a href="../exported_functions/getminfarversion.html">GetMinFarVersion</a>
</div>

</body>
</html>
