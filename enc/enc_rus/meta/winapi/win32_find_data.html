<!DOCTYPE html>
<html lang="ru">
<head>
<title>WIN32_FIND_DATA</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" type="text/css" href="../../styles/styles.css">
<script src="../links.js"></script>
</head>
<body>

<h1>WIN32_FIND_DATA</h1>
<div class="navbar">
<a href="../index.html">главная</a> |
<a href="../structures/index.html">структуры</a> |
<a href="index.html">win32 структуры</a>
</div>


<div class="shortdescr">
Структура <code>WIN32_FIND_DATA</code> описывает
файл, найденный функциями <code><a class="msdocs">FindFirstFile</a></code>, <code><a class="msdocs">FindFirstFileEx</a></code>
или <code><a class="msdocs">FindNextFile</a></code>.
</div>

<pre class="syntax">
typedef struct _WIN32_FIND_DATA {
  DWORD dwFileAttributes;
  FILETIME ftCreationTime;
  FILETIME ftLastAccessTime;
  FILETIME ftLastWriteTime;
  DWORD nFileSizeHigh;
  DWORD nFileSizeLow;
  DWORD dwReserved0;
  DWORD dwReserved1;
  TCHAR cFileName[ MAX_PATH ];
  TCHAR cAlternateFileName[ 14 ];
} WIN32_FIND_DATA;
</pre>

<h3>Элементы</h3>
<div class="descr">
    <div class="dfn">dwFileAttributes</div>
    <div class="dfndescr">Указывает атрибуты найденного файла. Этот элемент может быть комбинацией
    следующих значений:

       <table class="cont">
       <tr><th>Атрибут</th><th>Описание</th></tr>
        <tr><td><a name="FILE_ATTRIBUTE_ARCHIVE">FILE_ATTRIBUTE_ARCHIVE</a></td>
        <td><p>Это архивный файл.</p>
          <p>Приложения должны использовать этот флаг для копирования, архивирования или удаления.</p></td></tr>

        <tr><td><a name="FILE_ATTRIBUTE_COMPRESSED">FILE_ATTRIBUTE_COMPRESSED</a></td>
        <td><p>Файл или каталог сжат.</p>
          <p>Для файла это означает, что все данные его сжаты, для каталога - что компрессия по умолчанию
          применяется ко всем его файлам и подкаталогам.</p></td></tr>

        <tr><td><a name="FILE_ATTRIBUTE_DIRECTORY">FILE_ATTRIBUTE_DIRECTORY</a></td>
        <td>Это каталог.</td></tr>

        <tr><td><a name="FILE_ATTRIBUTE_ENCRYPTED">FILE_ATTRIBUTE_ENCRYPTED</a></td>
        <td><p>Файл или каталог зашифрован.</p>
          <p>Для файла, это означает, что все данные в файле зашифрованы, для каталога - что шифрование является умолчанием для
          вновь созданных файлов и подкаталогов.</p></td></tr>

        <tr><td><a name="FILE_ATTRIBUTE_HIDDEN">FILE_ATTRIBUTE_HIDDEN</a></td>
        <td><p>Файл скрыт.</p><p>Такой файл не включается в обычный листинг каталога.</p></td></tr>

        <tr><td><a name="FILE_ATTRIBUTE_NORMAL">FILE_ATTRIBUTE_NORMAL</a></td>
        <td><p>У этого файла не установлены другие атрибуты.</p>
          <p>Это значение корректно только при использовании без остальных флагов.</p></td></tr>

        <tr><td><a name="FILE_ATTRIBUTE_OFFLINE">FILE_ATTRIBUTE_OFFLINE</a></td>
        <td><p>Данные файла не доступны непосредственно.</p>
          <p>Означает, что реальные данные файла были физически перемещены на устройства хранения.</p></td></tr>

        <tr><td><a name="FILE_ATTRIBUTE_READONLY">FILE_ATTRIBUTE_READONLY</a></td>
        <td><p>Файл только для чтения.</p>
          <p>Приложения могут читать такой файл, но не могут записывать или удалять его.</p></td></tr>

        <tr><td><a name="FILE_ATTRIBUTE_REPARSE_POINT">FILE_ATTRIBUTE_REPARSE_POINT</a></td>
        <td>Каталог является <a href="../other/dict.html#symboliclinks">точкой повторной обработки</a>.</td></tr>

        <tr><td><a name="FILE_ATTRIBUTE_SPARSE_FILE">FILE_ATTRIBUTE_SPARSE_FILE</a></td>
        <td>Файл является т.н. <a href="../other/dict.html#sparsefile">Разрежённым файлом</a>.</td></tr>

        <tr><td><a name="FILE_ATTRIBUTE_SYSTEM">FILE_ATTRIBUTE_SYSTEM</a></td>
        <td>Этот файл - часть операционной системы.</td></tr>

        <tr><td><a name="FILE_ATTRIBUTE_TEMPORARY">FILE_ATTRIBUTE_TEMPORARY</a></td>
        <td><p>Это временный файл.</p>
          <p>Приложения должны записывать в такой файл только в крайней необходимости.
          Большая часть данных файла находится в памяти и не сбрасывается на диск, так как файл будет удалён.</p></td></tr>

        <tr><td><a name="FILE_ATTRIBUTE_NOT_CONTENT_INDEXED">FILE_ATTRIBUTE_NOT_CONTENT_INDEXED</a></td>
        <td>Этот файл или каталог не будут индексироваться службой индексирования.</td></tr>

        <tr><td><a name="FILE_ATTRIBUTE_VIRTUAL">FILE_ATTRIBUTE_VIRTUAL</a></td>
        <td>Этот файл - виртуальный файл.</td></tr>
       </table>
    </div>

    <div class="dfn">ftCreationTime</div>
    <div class="dfndescr"><p>Время создания - структура <a href="filetime.html">FILETIME</a>,
    содержащая время создания файла.</p>
    <p><a class="msdocs">FindFirstFile</a> и <a class="msdocs">FindNextFile</a>
    возвращают время файла в UTC-формате.
    Эти функции устанавливают элементы <code>FILETIME</code> в ноль, если файловая
    система, содержащая файл, не поддерживает этот временной атрибут.</p>
    <p>Вы можете использовать функцию <a class="msdocs">FileTimeToLocalFileTime</a>
    для преобразования из UTC в локальное время и тогда использовать
    функцию <a class="msdocs">FileTimeToSystemTime</a>
    для преобразования
    локального времени в структуру <a href="systemtime.html">SYSTEMTIME</a>
    содержащую отдельные элементы для месяца, дня, года и так далее...</p></div>

    <div class="dfn">ftLastAccessTime</div>
    <div class="dfndescr"><p>Структура <a href="filetime.html">FILETIME</a> с временем последнего
    доступа к файлу (чтение, запись, исполнение).</p>
    <p>Для каталогов в этой компоненте содержится информация о времени создания каталога.</p>
    <p>На FAT дата для файлов и каталогов будет правильна, но время дня будет всегда установлено на полночь.</p>
    <p>Время хранится в UTC формате; элементы структуры установлены в ноль, если файловая система не поддерживает этого свойства.</p>
    </div>

    <div class="dfn">ftLastWriteTime</div>
    <div class="dfndescr"><p>Структура <a href="filetime.html">FILETIME</a> с временем последней
    записи в файл (с помощью функций <a class="msdocs">WriteFile</a> или
    <a class="msdocs">SetEndOfFile</a>).</p>
    <p>Время последней записи не обновляется для таких операций, как
    установка атрибутов файла или изменение дескриптора безопасности (security descriptors).</p>
    <p>Для каталогов в этой компоненте содержится информация о времени создания каталога.</p>
    <p>Время хранится в UTC формате; элементы структуры
    установлены в ноль, если файловая система не поддерживает этого свойства.</p></div>

    <div class="dfn">nFileSizeHigh</div>
    <div class="dfndescr"><p>Старшее двойное слово 64-х разрядного размера файла в байтах.</p>
      <p>Размер файла равен <code>(<var>nFileSizeHigh</var> * (1+MAXDWORD)) + <var>nFileSizeLow</var></code>.</p></div>

    <div class="dfn">nFileSizeLow</div>
    <div class="dfndescr">Младшее двойное слово размера файла в байтах.</div>

    <div class="dfn">dwReserved0</div>
    <div class="dfndescr"><p>Если поле <code>dwFileAttributes</code> содержит атрибут
       <code>FILE_ATTRIBUTE_REPARSE_POINT</code>, это поле содержит тип
       <a href="../other/dict.html#symboliclinks">точки повторной обработки</a>.</p>
       <p>В противном случае значение этого поля не определено и не должно
       использоваться.</p></div>

    <div class="dfn">dwReserved1</div>
    <div class="dfndescr">Резерв.</div>

    <div class="dfn">cFileName</div>
    <div class="dfndescr">Строка с именем файла, заканчивающаяся символом конца строки (0x00).</div>

    <div class="dfn">cAlternateFileName</div>
    <div class="dfndescr">Альтернативное имя файла (классическая 8.3 (filename.ext) форма).</div>

</div>

<h3>Замечания</h3>
<div class="descr">
<ul>
<li><p>Если файл имеет длинное имя, полное имя возвращается в элементе <code>cFileName</code>
  а усечённая версия формата 8.3 сохраняется в <code>cAlternateFileName</code>.
  Иначе <code>cAlternateFileName</code> пусто.</p>
  <p>Как альтернативу вы можете использовать функцию <a class="msdocs">GetShortPathName</a>
  для возвращения 8.3-вида имени файла.</p>
</li>
<li><p>Не все файловые системы позволяют хранить время создания файла и
  последнего доступа к нему, и не все системы хранят их одинаково.</p>
  <p>Например, в файловой системе FAT под Windows NT время создания файла записывается с
  разрешением 10 миллисекунд, время последней модификации - 2 секунды, а время
  доступа - 1 день (то есть, фактически, записывается только дата доступа).</p>
  <p>На файловой системе NTFS время доступа имеет разрешение 1 час.</p>
</li>
</ul>
</div>

<div class="see">Смотрите также:</div>
<div class="seecont">
<a href="filetime.html">FILETIME</a>
</div>

</body>
</html>
