<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>

<head>
<title>Функции - Макросы</title>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
<link rel="stylesheet" type="text/css" href="../../../styles/styles.css">
</head>

<body>

<h1>Функции</h1>
<div class="navbar">
<a href="../../index.html">главная</a> |
<a href="../index.html">Макросы</a> |
<a href="index.html">Макроязык</a>
</div>

<p>В макропоследовательности допускаются следующие функции:

<table class="cont">
  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Математические функции</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="abs">abs</a></dfn>(N)</td>
    <td class="cont" width="60%">Возвращает абсолютную величину числового аргумента <em>N</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="max">max</a></dfn>(N1,N2)</td>
    <td class="cont" width="60%">Возвращает максимальное значение между двумя числовыми аргументами <em>N1</em> и <em>N2</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="min">min</a></dfn>(N1,N2)</td>
    <td class="cont" width="60%">Возвращает минимальное значение между двумя числовыми аргументами <em>N1</em> и <em>N2</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="mod">mod</a></dfn>(N1,N2)</td>
    <td class="cont" width="60%">Деление <em>N1</em> по модулю <em>N2</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="int">int</a></dfn>(V)</td>
    <td class="cont" width="60%">Приведение значения выражения <em>V</em> к числу.</td>
  </tr>

  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Строковые функции</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="index">index</a></dfn>(S1,S2)</td>
    <td class="cont" width="60%">Если подстрока <em>S2</em> содержится в строке <em>S1</em>,
      то возвращается ее позиция, иначе -1.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="rindex">rindex</a></dfn>(S1,S2)</td>
    <td class="cont" width="60%">Если подстрока <em>S2</em> содержится в строке <em>S1</em>,
      то возвращается ее позиция, иначе -1. Поиск ведется от конца строки <em>S1</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">Result=<dfn><a name="replace">replace</a></dfn>(Str,Find,Replace[,Cnt])</td>
    <td class="cont" width="60%">В строке <em>Str</em> заменить подстроку <em>Find</em> на подстроку <em>Replace</em> <em>Cnt</em> раз
      (укажите <em>Cnt</em> равное 0 или опустите этот параметр для замены всех найденных подстрок).<br>
      Возвращается результат замены.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="asc">asc</a></dfn>(S)</td>
    <td class="cont" width="60%">Возвращает код символа <em>S</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="chr">chr</a></dfn>(N)</td>
    <td class="cont" width="60%">Возвращает символ, заданный кодом <em>N</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="itoa">itoa</a></dfn>(N[,Radix])</td>
    <td class="cont" width="60%">Конвертирует целое число <em>N</em> в строку.
    Значение <em>Radix</em> определяет базу, которая должна использоваться при
    преобразовании числа <em>N</em>. Допустимые значения <em>Radix</em> от 2 до 36.<br>
    Если параметр <em>Radix</em> не указан, то подразумевается база 10.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="atoi">atoi</a></dfn>(S[,Radix])</td>
    <td class="cont" width="60%">Конвертирует строковое представление строки <em>N</em> в число.
    Значение <em>Radix</em> определяет базу, которая будет использоваться при
    преобразовании строки <em>S</em>. Допустимые значения <em>Radix</em> от 2 до 36.<br>
    Если параметр <em>Radix</em> не указан, то функция попытается сама определить в каком виде представлено строковое представление числа.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="len">len</a></dfn>(V)</td>
    <td class="cont" width="60%">Возвращает длину выражения <em>V</em>. Числовое
      значение выражения <em>V</em> приводится к строке, после чего
      вычисляется длина строки).</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="string">string</a></dfn>(V)</td>
    <td class="cont" width="60%">Перевод значения выражения <em>V</em> в строку.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="substr">substr</a></dfn>(V,N1[,N2])</td>
    <td class="cont" width="60%">Возвращает подстроку из выражения <em>V</em>
      начиная с позиции <em>N1</em> длинной <em>N2</em>.<br>
      Если параметр <em>N2</em> не указан или равен -1, то вернется подстрока от позиции <em>N1</em> до конца строки.<br>
      Если параметр <em>N2</em> равен 0, то вернется пустая строка.<br>
      </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="trim">trim</a></dfn>(V[,N])</td>
    <td class="cont" width="60%">Удаляет все пробельные символы (пробелы, табуляции,
      переводы строк и возвраты каретки) из строки <em>V</em> снаружи (<em>N</em>=0 или не указан), слева (<em>N</em>=1) или справа (<em>N</em>=2).
      </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="xlat">xlat</a></dfn>(S)</td>
    <td class="cont" width="60%">Возвращает транслитерируемую строку<br>
      Функция аналогична макрокоманде $XLat, но используется в
      выражениях. Строковый аргумент <em>S</em> обязателен.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="lcase">lcase</a></dfn>(S)</td>
    <td class="cont" width="60%">Преобразует строку <em>S</em> в нижний регистр.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="ucase">ucase</a></dfn>(S)</td>
    <td class="cont" width="60%">Преобразует строку <em>S</em> в верхний регистр.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="date">date</a></dfn>(format)</td>
    <td class="cont" width="60%">Возвращает текущую дату/время по формату <em>format</em>
      (описание <em>format</em> см. в $Date).<br>
      Функция аналогична макрокоманде $Date, но используется в
      выражениях. Строковый аргумент <em>format</em> в отличии от
      макрокоманды $Date обязателен.</td>
  </tr>


  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Файловые функции</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="fsplit">fsplit</a></dfn>(path,N)</td>
    <td class="cont" width="60%">Разбивает путь <em>path</em> на компоненты и возвращает их комбинацию, в
     зависимости от набора флагов <em>N</em>:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Флаги</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000001</td><td class="cont" width="90%">Текущий диск в формате "C:".<br>Для сетевых каталогов - "\\server\share"</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000002</td><td class="cont" width="90%">Путь в формате "\Program Files\Far\"</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000004</td><td class="cont" width="90%">Имя</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000008</td><td class="cont" width="90%">Расширение в формате ".EXT" или пусто, если расширения нет.</td></tr>
       </table>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="fexist">fexist</a></dfn>(S)</td>
    <td class="cont" width="60%">Проверяет существование файла/каталога <em>S</em> (возвращает 0 или 1).<br>
      В параметр <em>S</em> допускается использование символов '*' и '?'. В этом случае функция
      проверяет только первое вхождение файла/каталога.<br>
      Функция не работает с панелями.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="fattr">fattr</a></dfn>(S)</td>
    <td class="cont" width="60%">Возвращает файловые атрибуты файла/каталога <em>S</em>
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Атрибут</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000001</td><td class="cont" width="90%">FILE_ATTRIBUTE_READONLY. Файл только для чтения. Приложения могут читать такой файл, но не могут записывать или удалять его.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000002</td><td class="cont" width="90%">FILE_ATTRIBUTE_HIDDEN. Файл скрыт. Такой файл не включается в обычный листинг каталога.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000004</td><td class="cont" width="90%">FILE_ATTRIBUTE_SYSTEM. Этот файл - часть операционной системы.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000010</td><td class="cont" width="90%">FILE_ATTRIBUTE_DIRECTORY. Это каталог.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000020</td><td class="cont" width="90%">FILE_ATTRIBUTE_ARCHIVE. Это архивный файл. Приложения должны использовать этот флаг для копирования, архивирования или удаления.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000080</td><td class="cont" width="90%">FILE_ATTRIBUTE_NORMAL. У этого файла не установлены другие атрибуты. Это значение корректно только при использовании без остальных флагов.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000100</td><td class="cont" width="90%">FILE_ATTRIBUTE_TEMPORARY. Это временный файл. Приложения должны записывать в такой файл только в крайней необходимости. Большая часть данных файла находится в памяти и не сбрасывается на диск, так как файл будет удален.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000200</td><td class="cont" width="90%">FILE_ATTRIBUTE_SPARSE_FILE. Файл является т.н. "Sparse file".</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000400</td><td class="cont" width="90%">FILE_ATTRIBUTE_REPARSE_POINT. Каталог является символической связью.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000800</td><td class="cont" width="90%">FILE_ATTRIBUTE_COMPRESSED. Файл или каталог сжат. Для файла это означает, что все данные его сжаты, для каталога - что компрессия по умолчанию применяется ко всем его файлам и подкаталогам.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00001000</td><td class="cont" width="90%">FILE_ATTRIBUTE_OFFLINE. Данные файла не доступны непосредственно. Означает, что реальные данные файла были физически перемещены на устройства хранения.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00002000</td><td class="cont" width="90%">FILE_ATTRIBUTE_NOT_CONTENT_INDEXED. Этот файл или каталог не будут индексироваться службой индексирования.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00004000</td><td class="cont" width="90%">FILE_ATTRIBUTE_ENCRYPTED. Файл или каталог зашифрован. Для файла, это означает, что все данные в файле зашифрованы. Для директория, это означает, что шифрование является умолчанием для вновь созданных файлов и подкаталогов.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00010000</td><td class="cont" width="90%">FILE_ATTRIBUTE_VIRTUAL. Этот файл - виртуальный файл.</td></tr>

       </table>
       если файловый объект не существует, функция возвращает -1.<br>
       В параметр <em>S</em> допускается использование символов '*' и '?'. В этом случае функция
       возвращает атрибуты только для первого найденного файла/каталога.<br>
       Функция не работает с панелями.
    </td>
  </tr>


  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Панель</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="panel.fexist">panel.fexist</a></dfn>(panelType,S)</td>
    <td class="cont" width="60%">Проверяет существование файла/каталога <em>S</em> из активной (<em>panelType</em>=0) или пассивной (<em>panelType</em>=1) панели (возвращает 0 или 1).<br>
      В параметр <em>S</em> допускается использование символов '*' и '?'. В этом случае функция
      проверяет только первое вхождение файла/каталога.<br>
      Функция работает только с панелями.
     </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="panel.fattr">panel.fattr</a></dfn>(panelType,S)</td>
    <td class="cont" width="60%">Возвращает файловые атрибуты файла/каталога <em>S</em> из активной (<em>panelType</em>=0) или пассивной (<em>panelType</em>=1) панели.<br>
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Атрибут</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000001</td><td class="cont" width="90%">FILE_ATTRIBUTE_READONLY. Файл только для чтения. Приложения могут читать такой файл, но не могут записывать или удалять его.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000002</td><td class="cont" width="90%">FILE_ATTRIBUTE_HIDDEN. Файл скрыт. Такой файл не включается в обычный листинг каталога.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000004</td><td class="cont" width="90%">FILE_ATTRIBUTE_SYSTEM. Этот файл - часть операционной системы.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000010</td><td class="cont" width="90%">FILE_ATTRIBUTE_DIRECTORY. Это каталог.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000020</td><td class="cont" width="90%">FILE_ATTRIBUTE_ARCHIVE. Это архивный файл. Приложения должны использовать этот флаг для копирования, архивирования или удаления.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000080</td><td class="cont" width="90%">FILE_ATTRIBUTE_NORMAL. У этого файла не установлены другие атрибуты. Это значение корректно только при использовании без остальных флагов.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000100</td><td class="cont" width="90%">FILE_ATTRIBUTE_TEMPORARY. Это временный файл. Приложения должны записывать в такой файл только в крайней необходимости. Большая часть данных файла находится в памяти и не сбрасывается на диск, так как файл будет удален.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000200</td><td class="cont" width="90%">FILE_ATTRIBUTE_SPARSE_FILE. Файл является т.н. "Sparse file".</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000400</td><td class="cont" width="90%">FILE_ATTRIBUTE_REPARSE_POINT. Каталог является символической связью.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000800</td><td class="cont" width="90%">FILE_ATTRIBUTE_COMPRESSED. Файл или каталог сжат. Для файла это означает, что все данные его сжаты, для каталога - что компрессия по умолчанию применяется ко всем его файлам и подкаталогам.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00001000</td><td class="cont" width="90%">FILE_ATTRIBUTE_OFFLINE. Данные файла не доступны непосредственно. Означает, что реальные данные файла были физически перемещены на устройства хранения.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00002000</td><td class="cont" width="90%">FILE_ATTRIBUTE_NOT_CONTENT_INDEXED. Этот файл или каталог не будут индексироваться службой индексирования.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00004000</td><td class="cont" width="90%">FILE_ATTRIBUTE_ENCRYPTED. Файл или каталог зашифрован. Для файла, это означает, что все данные в файле зашифрованы. Для директория, это означает, что шифрование является умолчанием для вновь созданных файлов и подкаталогов.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00010000</td><td class="cont" width="90%">FILE_ATTRIBUTE_VIRTUAL. Этот файл - виртуальный файл.</td></tr>

       </table>
       если файловый объект не существует, функция возвращает -1.<br>
       В параметр <em>S</em> допускается использование символов '*' и '?'. В этом случае функция
       возвращает атрибуты только для первого найденного файла/каталога.<br>
       Функция работает только с панелями.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="panelitem">panelitem</a></dfn>(panelType,itemIndex,propIndex)</td>
    <td class="cont" width="60%">Возвращает различную информацию для элемента панели <em>itemIndex</em> (начиная с 1)
      из активной (<em>panelType</em>=0) или пассивной (<em>panelType</em>=1) панели. <em>propIndex</em> может быть
      одним из следующих значений:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Значение</th><th class="cont" width="10%">Тип</th><th class="cont" width="80%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Имя файла/каталога</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Короткое имя</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Файловые атрибуты</td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Дата/время создания</td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Дата/время последнего доступа</td></tr>
        <tr class="cont"><td class="cont" width="10%">5</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Дата/время модификации</td></tr>
        <tr class="cont"><td class="cont" width="10%">6</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Размер</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Упакованный размер</td></tr>
        <tr class="cont"><td class="cont" width="10%">8</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">"Выделен?"</td></tr>
        <tr class="cont"><td class="cont" width="10%">9</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Количество линков</td></tr>
        <tr class="cont"><td class="cont" width="10%">10</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">SortGroup</td></tr>
        <tr class="cont"><td class="cont" width="10%">11</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Diz-текст</td></tr>
        <tr class="cont"><td class="cont" width="10%">12</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Владелец</td></tr>
        <tr class="cont"><td class="cont" width="10%">13</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">CRC32</td></tr>
        <tr class="cont"><td class="cont" width="10%">14</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Позиция элемента в процессе чтения файловой системы</td></tr>
       </table>
       Для панели "Дерево папок" возвращается только имя файла (<em>propIndex</em>=0), остальные значения <em>propIndex</em> игнорируются.<br>
       Дата/время возвращается в формате DD.MM.YYYY HH:MM:SS. Разделители и порядок в дате зависят от региональных настроек.<br>
       Для получения данных о текущем файле (под курсором) <em>itemIndex</em> должен быть равен 0.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="panel.setpos">panel.setpos</a></dfn>(panelType,fileName)</td>
    <td class="cont" width="60%">Позиционирует курсор на элемент с именем <em>fileName</em> на активной (<em>panelType</em>=0) или пассивной (<em>panelType</em>=1) панели.<br>
      Возвращает позицию элемента или 0, если такого элемента на панели нет.<br>
      Например, создать каталог с именем, соответствующим текущей дате в формате YYYYMMDD, если каталог существует - позиционировать на него курсор:
      <pre class=code>%dt=date("%Y%m0%d");
$If (fexist(%dt))
  panel.SetPos(0,%dt)
$Else
  F7 $Text %dt Enter
$End</pre>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="panel.setpath">panel.setpath</a></dfn>(panelType,pathName[,fileName])</td>
    <td class="cont" width="60%">На активной (<em>panelType</em>=0) или пассивной (<em>panelType</em>=1) панели выставляет каталог <em>pathName</em> и
      позиционирует курсор на элемент с именем <em>fileName</em> (если указан параметр <em>fileName</em>).<br>
      Возвращает 1 в случае успешной установки каталога и 0, если каталог не существует.<br>
      Например, на активной панели выставить каталог "C:\WINDOWS", на пассивной - "C:\Program Files", активную панель сделать слева и установить курсор на каталог "FAR":
      <pre class=code>$if(APanel.Left) CtrlU $End
panel.SetPath(1,"C:\\WINDOWS")
panel.SetPath(0,"C:\\Program Files","FAR")</pre>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="panel.setposidx">panel.setposidx</a></dfn>(panelType,indexItem)</td>
    <td class="cont" width="60%">Позиционирует курсор на элемент с индексом <em>indexItem</em> на активной (<em>panelType</em>=0) или пассивной (<em>panelType</em>=1) панели.<br>
      Возвращает позицию элемента или 0, если такого элемента на панели нет.<br>
    </td>
  </tr>

  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Управляющие функции</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="iif">iif</a></dfn>(Cond,True,False)</td>
    <td class="cont" width="60%">Условный оператор. Если условие <em>Cond</em> верно,
      то возвращается <em>True</em>-выражение, иначе <em>False</em>-выражение.</td>
  </tr>

  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Среда исполнения</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="env">env</a></dfn>(V)</td>
    <td class="cont" width="60%">Возвращает значение переменной среды V,
      например,<br>
      <pre class=code>$if (Env(&quot;FARLANG&quot;) == &quot;English&quot;) <em>что-то делаем</em> $end</pre></td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">B=<dfn><a name="msave">msave</a></dfn>(S)</td>
    <td class="cont" width="60%">Сохраняет значение глобальной переменной с именем <em>S</em> в область <dfn>Vars</dfn>.
     В случае неудачи возвращает 0.<br>
     Например, <pre class=code>%%GlobalVars="Foo Bar"; %a=msave("%%GlobalVars");</pre>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="akey">akey</a></dfn>(N)</td>
    <td class="cont" width="60%">Возвращает название или код клавиши, вызвавшей макропоследовательность.
       <em>N</em> = 0 - возвращается код клавиши, <em>N</em> = 1 - возвращается наименование клавиши.<br>
       Пример см. в описании <a href="akey.html">$AKey</a></td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="clip">clip</a></dfn>(Cmd[,S])</td>
    <td class="cont" width="60%">Позволяет производить разнообразные манипуляции с Clipboard в
         зависимости от команды <em>Cmd</em>:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Cmd</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">Возвращает данные из Clipboard; параметр <em>S</em> игнорируется; в случае ошибки возвращает 0</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">Поместить строку <em>S</em> в Clipboard; в случае ошибки возвращает 0</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">Добавить строку <em>S</em> к Clipboard; в случае ошибки возвращает 0</td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="90%">Копировать Windows Clipboard во внутренний буфер обмена; параметр <em>S</em> игнорируется; в случае ошибки возвращает 0</td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="90%">Копировать внутренний буфер обмена в Windows Clipboard; параметр <em>S</em> игнорируется; в случае ошибки возвращает 0</td></tr>
       </table>
       Например, поместить в Clipboard список отмеченных файлов в формате CSV (имя и размер):
       <pre class=code>Clip(1,"Name;Size\r\n")
Home
$While(!APanel.Eof)
  $If(!APanel.Folder &amp;&amp; PanelItem(0,0,8))
     Clip(2,PanelItem(0,0,0)+";"+PanelItem(0,0,6)+"\r\n")
  $End
  Down
$End</pre>
       См. так же <a href="iclip.html">$IClip</a>, <a href="boolstate.html#iclip">IClip</a>.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="flock">flock</a></dfn>(Nkey,NState)</td>
    <td class="cont" width="60%">Позволяет переключить состояние Lock-клавиш (NumLock, CapsLock и ScrollLock).<br>
    Клавиша <em>Nkey</em>:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Nkey</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">NumLock</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">CapsLock</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">ScrollLock</td></tr>
       </table>
    Состояние <em>NState</em>:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">NState</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">-1</td><td class="cont" width="90%">получить состояние клавиши</td></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">погасить индикатор</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">включить индикатор</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">переключить индикатор в противоположное состояние</td></tr>
       </table>
    В Windows 95/98/Me функция может изменять только состояние клавиш CapsLock и ScrollLock. Для линейки NT (NT/2000/XP/...) этого ограничения нет.<br>
    Функция капризная (возможно зависание компьютера), поэтому пользоваться ей надо осторожно. Например, макрос, повешенный на CtrlCapsLock (переключение между окнами) должен иметь некую обвязку:
       <pre class=code>CtrlShiftTab
%a=flock(1,-1)&1;
$while((flock(1,-1)&1)==%a)
  sleep(50)
  flock(1,2)
$end</pre>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="sleep">sleep</a></dfn>(N)</td>
    <td class="cont" width="60%">Организация задержки в макросе на <em>N</em> миллисекунд.
     Отрицательное значение задержки считается ошибкой и функция возвращает 0.<br>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="waitkey">waitkey</a></dfn>([N, [T]])</td>
    <td class="cont" width="60%">Ожидает любую клавишу и возвращает ее название (<em>T</em>=0) или значение (<em>T</em>=1).
     Если время ожидания <em>N</em> (миллисекунды) истекло, функция возвращает пустую строку (<em>T</em>=0) или 0 (<em>T</em>=1).
     Если параметр <em>N</em> не указан или равен 0, то функция будет бесконечно ждать нажатия клавиши.
     <br>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="key">key</a></dfn>(V)</td>
    <td class="cont" width="60%">Преобразует параметр <em>V</em> в строковый эквивалент названия клавиши.<br>
     Если <em>V</em> строка, то проверяется правильность написания клавиши и она же возвращается,
     если <em>V</em> число, то происходит попытка преобразовать значение в текстовый эквивалент названия клавиши.<br>
     В случае ошибок - возвращается пустая строка.
     <br>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="eval">eval</a></dfn>(S)</td>
    <td class="cont" width="60%">"Проиграть" макропоследовательность заданную строкой <em>S</em>.
      Если <em>S</em> содержит синтаксические ошибки, то макропоследовательность исполняться не будет.
     <br>
     FAR компилирует последовательность <em>S</em>. Если нет ошибок, то состояние текущего макроса сохраняется
     и начинает выполняться последовательность <em>S</em>. После исполнения <em>S</em> прерванный макрос продолжает работать.
     <p>Функция возвращает 0 в случае успешной компиляции последовательности <em>S</em>.
     <p>Локальные переменные - общие для текущего исполняемого макроса и макропоследовательности, исполняемой функцией <dfn>eval</dfn>.
     <p>Например, необходимо по F10 запускать окно проводника для каталога на активной панели, содержимое командной строки должно сохраняться.<br>
     В области Vars задаем 2 строковых переменных макропроцедуры, описывающие сохранение и восстановление содержимое командной строки:
<pre class=code>
%%CmdSave=$If (!CmdLine.Empty) %Flg_Cmd=1;
          %CmdCurPos=CmdLine.ItemCount-CmdLine.CurPos+1;
          %CmdVal=CmdLine.Value; Esc $End

%%CmdRestore=$If (%Flg_Cmd==1) $Text %CmdVal
          %Flg_Cmd=0; %Num=%CmdCurPos;
          $While (%Num!=0) %Num=%Num-1; CtrlS $End $End
</pre>
     далее на F10 вешаем макрос:
<pre class=code>
$If (APanel.Visible &amp;&amp; (!APanel.Plugin || (!APanel.Bof &amp;&amp;(APanel.OPIFlags &amp; 0x20))))
  Eval(%%CmdSave)
  $If (APanel.Current == "..")
    .
    ShiftEnter
  $Else
    "%SystemRoot%\\explorer.exe /select,"
    $If (Apanel.LFN)
      CtrlN
    $End
    CtrlEnter
    $If (!Apanel.LFN)
      CtrlN
    $End
    Enter
  $End
  Eval(%%CmdRestore)
$End
</pre>

    </td>
  </tr>

  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Взаимодействие с пользователем</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="msgbox">msgbox</a></dfn>([Title[,Text[,Flags]]])</td>
    <td class="cont" width="60%">
      Показывает сообщение <em>Text</em> с заголовком <em>Title</em>.
      В параметре <em>Text</em> строки разбиваются символом '\n'.<br>
      <em>Flags</em> может быть набором следующих значений:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Flags</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000001</td><td class="cont" width="90%">Используются цвета "Предупреждения" (обычно белые буквы на красном фоне).</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000008</td><td class="cont" width="90%">Показать сообщение двумя строками ниже.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000010</td><td class="cont" width="90%">Использовать для строк сообщения выравнивание влево (по умолчанию строки выводятся по центру).</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00010000</td><td class="cont" width="90%">Выводится кнопка &lt;Ok&gt;</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00020000</td><td class="cont" width="90%">Выводятся кнопки &lt;Ok&gt; и &lt;Cancel&gt;</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00030000</td><td class="cont" width="90%">Выводятся кнопки &lt;Abort&gt;, &lt;Retry&gt; и &lt;Ignore&gt;</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00040000</td><td class="cont" width="90%">Выводятся кнопки &lt;Yes&gt; и &lt;No&gt;</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00050000</td><td class="cont" width="90%">Выводятся кнопки &lt;Yes&gt;, &lt;No&gt; и &lt;Cancel&gt;</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00060000</td><td class="cont" width="90%">Выводятся кнопки &lt;Retry&gt; и &lt;Cancel&gt;</td></tr>
       </table>
       Если параметр <em>Flags</em> равен 0 (или не указан), то выводится стандартный диалог с кнопкой &lt;Ok&gt;<br>
       Функция возвращает 0, если пользователь отменил сообщение или выбранный номер кнопки
       (для первой кнопки - 1, для второй - 2 и так далее).
    </td>
  </tr>

  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="prompt">prompt</a></dfn>("Title"[,"Prompt"[,flags[, "Src"[, "History"]]]])</td>
    <td class="cont" width="60%">Функция позволяет ввести одну строку текста.<br>
      Параметры: <em>Title</em> - заголовок диалога, <em>Prompt</em> - приглашения для ввода, <em>Src</em> - начальное значение строки ввода, <em>History</em> - имя истории ввода<br>
      <em>Flags</em> может быть набором следующих значений (аналогичным константам <a href="../../service_functions/inputbox.html#INPUTBOXFLAGS">FIB_*</a>):
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Flags</th><th class="cont" width="90%">Описание</th></tr>
           <tr class="cont"><td class="cont" width="40%">0x00000001</td><td class="cont" width="60%">даже если строка ввода пуста функция вернет значение пустое значение.</td></tr>
           <tr class="cont"><td class="cont" width="40%">0x00000002</td><td class="cont" width="60%">используется для ввода пароля - вводимый текст на экране отрисовывается символами <code>'*'</code>.</td></tr>
           <tr class="cont"><td class="cont" width="40%">0x00000004</td><td class="cont" width="60%">после успешного ввода, в результирующем значении <em>S</em> идентификаторы переменных окружения заменяются на их значения, например, если пользователь ввел '<code>%TEMP%</code>', то <dfn>DestText</dfn> будет содержать '<code>C:\TEMP</code>'.</td></tr>
           <tr class="cont"><td class="cont" width="40%">0x00000008</td><td class="cont" width="60%">не использовать предыдущее значение из истории, оставить строку ввода пустой; актуален, если указан непустой параметр <em>History</em>.</td></tr>
           <tr class="cont"><td class="cont" width="40%">0x00000010</td><td class="cont" width="60%">показать разделительную линию и кнопки [Ok] и [Cancel]. Диалог увеличится на 2 строки.</td></tr>
           <tr class="cont"><td class="cont" width="40%">0x00000020</td><td class="cont" width="60%">не показывать в приглашении ввода амперсанд, использовать его для определения горячей клавиши.</td></tr>
       </table>
       Функция возвращает строку - введенное пользователем значение.<br>
       Например, запросить пароль и вывести его
      <pre class=code>%s=prompt("Password","Input password:",0x02); $Text %s</pre>
    </td>
  </tr>

  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Элементы управления</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="checkhotkey">checkhotkey</a></dfn>(S)</td>
    <td class="cont" width="60%">Возвращает 1, если в меню присутствует горячая
      клавиша <em>S</em> и текущий &quot;объект&quot; - меню. В противном
      случае возвращает 0.
      <p>Например, в меню вызова плагинов (F11) плагину S&amp;R назначена
      горячая клавиша '7'. Последовательность макрокоманды для
      редактора:
      <pre class=code>F11 $if (checkhotkey(&quot;7&quot;)) 7 1 $else Esc AltF7 $end</pre>
      вызовет плагин, если хоткей назначен или стандартный диалог
      поиска, если хоткей не назначен.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="gethotkey">gethotkey</a></dfn>(N)</td>
    <td class="cont" width="60%">Возвращает хоткей <em>S</em> для пункта <em>N</em>, если в меню присутствует горячая
      клавиша и текущий &quot;объект&quot; - меню. В противном случае (не меню; нет хоткея; N больше чем количество пунктов меню) возвращает 0.<br>
      Здесь <em>N</em> - позиция в списке от 1 (0 - текущая).
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="menu.select">Menu.Select</a></dfn>(S[,N])</td>
    <td class="cont" width="60%">В меню позиционирует курсор на первый пункт, содержащий подстроку <em>S</em>.
    Поиск подстроки ведется в зависимости от указанного режима <em>N</em>:
       <table class="cont">
        <tr class="cont"><th class="cont" width="40%">Режим</th><th class="cont" width="60%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="40%">0</td><td class="cont" width="60%">полное совпадение</td></tr>
        <tr class="cont"><td class="cont" width="40%">1</td><td class="cont" width="60%">совпадение с началом строки</td></tr>
        <tr class="cont"><td class="cont" width="40%">2</td><td class="cont" width="60%">совпадение с концом строки</td></tr>
        <tr class="cont"><td class="cont" width="40%">3</td><td class="cont" width="60%">присутствие подстроки <em>S</em> в пункте меню</td></tr>
       </table>
    Поиск регистронезависим. Если такого пункта нет, то ничего не делает.<br>
    Возвращает: -1=ошибка - функция вызвана не для меню, 0=ошибка при позиционировании (нет пункта или пункт задисаблен), иначе - позицию пункта меню.
    <pre class=code>F11 $if(Menu.Select(&quot;Advanced compare&quot;,0) > 0) Enter $end</pre>
    Если параметр <em>N</em> не указан, подразумевается полное совпадение.
  </td>
  </tr>

  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="Dlg.GetValue">Dlg.GetValue</a></dfn>(ID,Type)</td>
    <td class="cont" width="60%">Получить различные значения текущего диалога.<br>
      <em>ID</em> - номер элемента диалога (элементы нумеруются с 1; 0 - само диалоговое окно).<br>
      <em>Type</em> - тип получаемой информации, зависит от типа элемента. Для самого диалога (ID=0) допустимы следующие значения:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Type</th><th class="cont" width="10%">Тип Var</th><th class="cont" width="80%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Количество элементов диалога</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">X1</td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Y1</td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">X2</td></tr>
        <tr class="cont"><td class="cont" width="10%">5</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Y2</td></tr>
        <tr class="cont"><td class="cont" width="10%">6</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">ID текущего элемента, имеющего <a href="../../dialogapi/keybfocus.html">клавиатурный фокус ввода</a></td></tr>
       </table>

       Для элементов диалога допустимы:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Type</th><th class="cont" width="10%">Тип Var</th><th class="cont" width="10%">Элемент</th><th class="cont" width="70%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">CheckBox</td><td class="cont" width="70%">Состояние переключателя</td></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">RadioButtons</td><td class="cont" width="70%">Состояние переключателя</td></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">String</td><td class="cont" width="10%">ListBox</td><td class="cont" width="70%">Значение текущего элемента списка</td></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">String</td><td class="cont" width="10%">ComboBox</td><td class="cont" width="70%">Значение текущего элемента списка</td></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">String</td><td class="cont" width="10%">Остальные</td><td class="cont" width="70%">Текстовое значение (поле <a href="../../dialogapi/structures/fardialogitem.html">FarDialogItem.Data</a>)</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Все</td><td class="cont" width="70%"><a href="../../dialogapi/controls/index.html">Тип элемента</a></td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Все</td><td class="cont" width="70%">X1 относительно диалога</td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Все</td><td class="cont" width="70%">Y1 относительно диалога</td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Все</td><td class="cont" width="70%">X2 относительно диалога</td></tr>
        <tr class="cont"><td class="cont" width="10%">5</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Все</td><td class="cont" width="70%">Y2 относительно диалога</td></tr>
        <tr class="cont"><td class="cont" width="10%">6</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Все</td><td class="cont" width="70%">элемент в фокусе?</td></tr>

        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">CheckBox</td><td class="cont" width="70%">Состояние переключателя</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">RadioButtons</td><td class="cont" width="70%">Состояние переключателя</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">String</td><td class="cont" width="10%">ListBox</td><td class="cont" width="70%">Текущая позиция в списке (первый пункт списка = 1)</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">String</td><td class="cont" width="10%">ComboBox</td><td class="cont" width="70%">Текущая позиция в списке (первый пункт списка = 1)</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Остальные</td><td class="cont" width="70%">0</td></tr>

        <tr class="cont"><td class="cont" width="10%">8</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Все</td><td class="cont" width="70%"><a href="../../dialogapi/flags/index.html">Флаги элемента</a></td></tr>
        <tr class="cont"><td class="cont" width="10%">9</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Все</td><td class="cont" width="70%">Флаг, означающий, что данный элемент диалога является "элементом по умолчанию".</td></tr>

        <tr class="cont"><td class="cont" width="10%">10</td><td class="cont" width="10%">String</td><td class="cont" width="10%">Остальные</td><td class="cont" width="70%">Текстовое значение (поле <a href="../../dialogapi/structures/fardialogitem.html">FarDialogItem.Data</a>)</td></tr>
       </table>
       Возвращает -1, если <em>ID</em> больше количества элементов диалога или значение <em>Type</em> не поддерживается.<br>
    </td>
  </tr>

  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="Editor.Set">Editor.Set</a></dfn>(Idx,Var)</td>
    <td class="cont" width="60%">Для текущей копии редактора изменить настройки.
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Index</th><th class="cont" width="10%">Тип Var</th><th class="cont" width="80%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Размер табуляции</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Преобразование табуляции</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Постоянные блоки</td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Del удаляет блоки</td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Автоотступ</td></tr>
        <tr class="cont"><td class="cont" width="10%">5</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Автоопределение таблицы символов</td></tr>
        <tr class="cont"><td class="cont" width="10%">6</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">AnsiTableForNewFile</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Курсор за пределами строки</td></tr>
        <tr class="cont"><td class="cont" width="10%">8</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">поведением клавиши BackSpace (TechInfo #13)</td></tr>
        <tr class="cont"><td class="cont" width="10%">9</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Представление кода символа под курсором в статусной строке (TechInfo #32)</td></tr>
        <tr class="cont"><td class="cont" width="10%">10</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Сохранять позицию файла</td></tr>
        <tr class="cont"><td class="cont" width="10%">11</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Сохранять закладки</td></tr>
        <tr class="cont"><td class="cont" width="10%">12</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Символы разделители слов (TechInfo #1)</td></tr>
        <tr class="cont"><td class="cont" width="10%">13</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">EditorF7Rules (TechInfo #18)</td></tr>
        <tr class="cont"><td class="cont" width="10%">14</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">AllowEmptySpaceAfterEof (TechInfo #67)</td></tr>
       </table>
       Значение <em>Var</em> может быть равно -1, в этом случае функция ничего не изменит, а вернет текущее значение настройки.<br>
       Возвращает предыдущее значение опций или -1, если данные указаны некорректно.<br>
       Например, макрос, перемещающий выделенный фрагмент на одну строку вниз:
       <pre class=code>$IClip CtrlX %a=Editor.Set(2,1); Down CtrlV %a=Editor.Set(2,%a);</pre>
    </td>
  </tr>

  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="editor.sel">Editor.Sel</a></dfn>(Action[,Opt])</td>
    <td class="cont" width="60%">Функция позволяет производить некоторые операции с блоками в тексте (в редакторе, в строках ввода в диалогах, в командной строке).
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Action</th><th class="cont" width="90%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">получить параметры текущего блока
        <table class="cont">
          <tr class="cont"><th class="cont" width="10%">Opt</th><th class="cont" width="90%">Описание</th></tr>
          <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">вернуть номер строки начала блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">вернуть номер позиции в строке начала блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">вернуть номер строки конца блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="90%">вернуть номер позиции в строке конца блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="90%">вернуть тип выделенного блока: 0 - блок не выделен, 1 - обычный блок, 2 - вертикальный блок
            (альтернативный вариант - <a href="states.html#editor.state">Editor.State</a>)</td></tr>
        </table>
        </td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">позиционировать курсор внутри текущего блока (при позиционировании курсора состояние блока не изменяется)
        <table class="cont">
          <tr class="cont"><th class="cont" width="10%">Opt</th><th class="cont" width="90%">Описание</th></tr>
          <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">установить курсор в начало отмеченного блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">установить курсор в конец отмеченного блока</td></tr>
        </table>
        </td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">установка позиций блока
        <table class="cont">
          <tr class="cont"><th class="cont" width="10%">Opt</th><th class="cont" width="90%">Описание</th></tr>
          <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">отметить позицию начала блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">отметить позицию конца блока</td></tr>
        </table>
        Позицией начала/конца блока считается текущая позиция курсора. Блок помечается только после указания конечной позиции (<em>Opt</em>=1), с ранее выделенного блока пометка снимается.
        Если позиция начала и конца блока совпадают, то эта операция равносильна снятию пометки блока.
        </td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="90%">установка позиций вертикального блока
        <table class="cont">
          <tr class="cont"><th class="cont" width="10%">Opt</th><th class="cont" width="90%">Описание</th></tr>
          <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">отметить позицию начала вертикального блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">отметить позицию конца вертикального блока</td></tr>
        </table>
        Позицией начала/конца блока считается текущая позиция курсора. Блок помечается только после указания конечной позиции (<em>Opt</em>=1), с ранее выделенного блока пометка снимается.
        Если позиция начала и конца блока совпадают, то эта операция равносильна снятию пометки блока.
        </td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="90%">снять выделение с блока<br>
        Параметр <em>Opt</em> игнорируется.<br>
        Всегда возвращается 1
        </td></tr>
       </table>
       В случае ошибки (в т.ч. функция вызвана не из "редактора") возвращаемое значение равно 0, иначе 1. Для <em>Action</em>=0 возвращается запрошенное значение.
      <br>
      Например, повторим некоторые сочетания клавиш из Turbo-сред (макрос на сочетание Ctrl-K):
      <pre class=code>%k=waitkey(0,1);
$if(%k==B || %k==b || %k==CtrlB)
  editor.sel(2,0)
$else
  $if(%k==K || %k==k || %k==CtrlK)
    editor.sel(2,1)
  $else
    $if((%k==C || %k==c || %k==CtrlC) &amp;&amp; Selected)
      CtrlC
    $else
      $if((%k==Y || %k==y || %k==CtrlY) &amp;&amp; Selected)
        CtrlD
      $else
        eval("F1")
      $end
    $end
  $end
$end</pre>
    </td>
  </tr>


  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Работа с закладками</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Функция</th>
    <th class="cont" width="60%">Описание</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="BM.Add">BM.Add</a></dfn>()</td>
    <td class="cont" width="60%">Добавить текущие параметры закладки и обрезать хвост</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="BM.Clear">BM.Clear</a></dfn>()</td>
    <td class="cont" width="60%">Очистить все закладки</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="BM.Del">BM.Del</a></dfn>([Idx])</td>
    <td class="cont" width="60%">Удалить закладку с указанным индексом <em>Idx</em> (нумерация начинается с 1). Если параметр <em>Idx</em> не указан или равен 0 - удаляется текущая закладка.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="BM.Get">BM.Get</a></dfn>(Idx,M)</td>
    <td class="cont" width="60%">Получить параметры закладки с индексом <em>Idx</em> (нумерация начинается с 1), Idx=0 - текущая закладка.<br>
      Параметр <em>M</em> может быть одним из следующих:
       <table class="cont">
        <tr class="cont"><th class="cont" width="40%">Тип</th><th class="cont" width="60%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="40%">0</td><td class="cont" width="60%">координаты строки (начиная с 1)</td></tr>
        <tr class="cont"><td class="cont" width="40%">1</td><td class="cont" width="60%">координаты колонки (начиная с 1)</td></tr>
        <tr class="cont"><td class="cont" width="40%">2</td><td class="cont" width="60%">позиция, соответствующая первому видимому символу текста на экране слева</td></tr>
        <tr class="cont"><td class="cont" width="40%">3</td><td class="cont" width="60%">номер строки, соответствующей первой видимой строке текста на экране</td></tr>
       </table>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="BM.Next">BM.Next</a></dfn>()</td>
    <td class="cont" width="60%">Перейти на следующую закладку</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="BM.Prev">BM.Prev</a></dfn>()</td>
    <td class="cont" width="60%">Перейти на предыдущую закладку</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="BM.Stat">BM.Stat</a></dfn>([M])</td>
    <td class="cont" width="60%">Получить информацию о закладках.<br>
      Параметр <em>M</em> может быть одним из следующих:
       <table class="cont">
        <tr class="cont"><th class="cont" width="40%">Тип</th><th class="cont" width="60%">Описание</th></tr>
        <tr class="cont"><td class="cont" width="40%">0</td><td class="cont" width="60%">текущее количество закладок</td></tr>
       </table>
    </td>
  </tr>
  <tr class="cont"><td class="cont" colspan=2>Пример работы с закладками:<pre class=code>

  </pre></td></tr>

</table>


<h3>Замечания</h3>
<div class=descr>
<ol>
<li>Функции работы с закладками BM.XXX() доступны только в редакторе.
<li>Параметры функций, обозначенные в квадратных скобках можно не указывать. Значение по умолчанию см. в описаниях функций.
<li>Элементы макроязыка невозможно использовать во время <a href="../macrokey/record.html">записи
    макроса</a> стандартным образом. Добавить элементы языка в макрос можно только путем ручной
    правки реестра или путем применения специальных программ/плагинов.</li>
</ol>
</div>

</body>

</html>
