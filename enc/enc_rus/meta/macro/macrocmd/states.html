<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>

<head>
<title>Состояния - Макросы</title>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
<link rel="stylesheet" type="text/css" href="../../../styles/styles.css">
</head>

<body>

<h1>Состояния</h1>
<div class="navbar">
<a href="../../index.html">главная</a> |
<a href="../index.html">Макросы</a> |
<a href="index.html">Макроязык</a>
</div>

<div class=shortdescr>

</div>

<table class="cont">
  <tr class="cont"><th class="cont" colspan=3>Панели</th></tr>
  <tr class="cont"><th class="cont" width="20%">Оператор</th><th class="cont" width="20%">Тип</th><th class="cont" width="60%">Описание</th></tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.ItemCount">APanel.ItemCount</a><br>
    <a name="PPanel.ItemCount">PPanel.ItemCount</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">содержит количество файловых объектов на панели</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.SelCount">APanel.SelCount</a><br>
    <a name="PPanel.SelCount">PPanel.SelCount</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">содержит количество выделенных файлов на панели (число)</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.CurPos">APanel.CurPos</a><br>
    <a name="PPanel.CurPos">PPanel.CurPos</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">содержит порядковый номер файлового объекта на панели</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.Current">APanel.Current</a><br>
    <a name="PPanel.Current">PPanel.Current</a></td>
    <td class="cont" width="20%">String</td>
    <td class="cont" width="60%">содержит имя файла под курсором (строка)</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.Path">APanel.Path</a><br>
    <a name="PPanel.Path">PPanel.Path</a></td>
    <td class="cont" width="20%">String</td>
    <td class="cont" width="60%">содержит путь панели (без заключительного '\')</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.UNCPath">APanel.UNCPath</a><br>
    <a name="PPanel.UNCPath">PPanel.UNCPath</a></td>
    <td class="cont" width="20%">String</td>
    <td class="cont" width="60%">содержит UNC-путь панели (без заключительного '\')</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.Width">APanel.Width</a><br>
    <a name="PPanel.Width">PPanel.Width</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">содержит ширину панели</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.Type">APanel.Type</a><br>
    <a name="PPanel.Type">PPanel.Type</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">содержит тип панели:
      <table class="cont">
        <tr class="cont">
          <th class="cont" width="10%">Значение</th>
          <th class="cont" width="90%">Описание</th>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0</td>
          <td class="cont" width="90%">Файловая панель</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">1</td>
          <td class="cont" width="90%">Дерево папок</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">2</td>
          <td class="cont" width="90%">Панель быстрого просмотра</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">3</td>
          <td class="cont" width="90%">Информационная панель</td>
        </tr>
      </table>
    </td>
  </tr>

  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.DriveType">APanel.DriveType</a><br>
    <a name="PPanel.DriveType">PPanel.DriveType</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">содержит тип привода на панели:
      <table class="cont">
        <tr class="cont">
          <th class="cont" width="10%">Значение</th>
          <th class="cont" width="90%">Описание</th>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">-1</td>
          <td class="cont" width="90%">Плагиновая панель</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0</td>
          <td class="cont" width="90%">Не удалось определить тип привода</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">2</td>
          <td class="cont" width="90%">Сменный привод</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">3</td>
          <td class="cont" width="90%">Жесткий диск</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">4</td>
          <td class="cont" width="90%">Сетевой подмапленный диск</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">5</td>
          <td class="cont" width="90%">CDROM</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">6</td>
          <td class="cont" width="90%">Виртуальный диск</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">15</td>
          <td class="cont" width="90%">SUBST-диск</td>
        </tr>
      </table>
    </td>
  </tr>

  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.OPIFlags">APanel.OPIFlags</a><br>
    <a name="PPanel.OPIFlags">PPanel.OPIFlags</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">комбинация следующих значений плагиновой панели (если панель не плагиновая, то значение будет = 0):
<table class="cont">
<tr class="cont"><th class="cont" width="10%">Значение</th><th class="cont" width="90%">Описание</th></tr>

        <tr class="cont"><td class="cont" width="10%">0x00000001</td>
        <td class="cont" width="90%">используется фильтр на панели</td></tr>

        <tr class="cont"><td class="cont" width="10%">0x00000002</td>
        <td class="cont" width="90%">используются группы сортировки на панели</td></tr>

        <tr class="cont"><td class="cont" width="10%">0x00000004</td>
        <td class="cont" width="90%">используется раскраска файлов на панели</td></tr>

        <tr class="cont"><td class="cont" width="10%">0x00000010</td>
        <td class="cont" width="90%">папки на панели плагина выбираются независимо от настроек FAR</td></tr>

        <tr class="cont"><td class="cont" width="10%">0x00000020</td>
        <td class="cont" width="90%">используется стандартная обработка файла FAR'ом, если запрошенная операция не поддерживается плагином; если этот флаг указан, элементы на панели плагина являются именами реальных файлов</td></tr>

        <tr class="cont"><td class="cont" width="10%">0x00000040</td>
        <td class="cont" width="90%">показаны имена без путей</td></tr>

        <tr class="cont"><td class="cont" width="10%">0x00000080</td>
        <td class="cont" width="90%">имена файлов выровнены по правому краю</td></tr>

        <tr class="cont"><td class="cont" width="10%">0x00000100</td>
        <td class="cont" width="90%">имена файлов показаны в оригинальном регистре (независимо от настроек FAR)</td></tr>
      </table>
    </td>
  </tr>


  <tr class="cont"><th class="cont" colspan=3>Диалоги</th></tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Dlg.ItemCount">Dlg.ItemCount</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">количество элементов диалога</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Dlg.CurPos">Dlg.CurPos</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">номер текущего фокусного элемента диалога</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Dlg.ItemType">Dlg.ItemType</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">тип фокусного элемента диалога
      <table class="cont">
        <tr class="cont">
          <th class="cont" width="10%">Значение</th>
          <th class="cont" width="90%">Описание</th>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0</td>
          <td class="cont" width="90%">ошибка, например, Dlg.ItemType вызван не в диалоге</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">1</td>
          <td class="cont" width="90%">Поле ввода</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">2</td>
          <td class="cont" width="90%">Поле ввода пароля</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">3</td>
          <td class="cont" width="90%">Поле ввода фиксированного размера</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">4</td>
          <td class="cont" width="90%">Кнопка (Push Button)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">5</td>
          <td class="cont" width="90%">Контрольный переключатель (Check Box)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">6</td>
          <td class="cont" width="90%">Селекторная кнопка (Radio Button)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">7</td>
          <td class="cont" width="90%">Комбинированный список</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">8</td>
          <td class="cont" width="90%">Окно списка</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">9</td>
          <td class="cont" width="90%">Элемент управления, определяемый программистом</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x8001</td>
          <td class="cont" width="90%">Выбор из истории поля ввода</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x8007</td>
          <td class="cont" width="90%">Выбор из комбинированного списка</td>
        </tr>
      </table>
    </td>
  </tr>

  <tr class="cont"><th class="cont" colspan=3>Командная строка</th></tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="CmdLine.ItemCount">CmdLine.ItemCount</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">количество символов в командной строке</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="CmdLine.CurPos">CmdLine.CurPos</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">текущая позиция курсора в командной строке</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="CmdLine.Value">CmdLine.Value</a></td>
    <td class="cont" width="20%">String</td>
    <td class="cont" width="60%">содержимое командной строки</td>
  </tr>

  <tr class="cont"><th class="cont" colspan=3>Редактор</th></tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Editor.FileName">Editor.FileName</a></td>
    <td class="cont" width="20%">String</td>
    <td class="cont" width="60%">полное имя редактируемого файла</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Editor.CurLine">Editor.CurLine</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">номер текущей линии в редакторе (первая строка равна 1)</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Editor.CurPos">Editor.CurPos</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">текущая позиция курсора в строке в редакторе (начало строки равно 1)</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Editor.Value">Editor.Value</a></td>
    <td class="cont" width="20%">Value</td>
    <td class="cont" width="60%">содержимое текущей строки в редакторе под курсором.<br>
      Например, показать текущий символ под курсором
      <pre class="code">
MsgBox(substr(Editor.Value,Editor.CurPos-1,1),Editor.FileName,0)
</pre>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Editor.Lines">Editor.Lines</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">количество строк в редакторе</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Editor.State">Editor.State</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">различные состояния текущего редактора - набор
      битовых флагов:
      <table class="cont">
        <tr class="cont">
          <th class="cont" width="10%">Значение</th>
          <th class="cont" width="90%">Описание</th>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000001</td>
          <td class="cont" width="90%">файл совершенно новый либо его успели удалить</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000002</td>
          <td class="cont" width="90%">разрешено переключение на программу просмотра по F6</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000004</td>
          <td class="cont" width="90%">после закрытия редактора удалить файл</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000008</td>
          <td class="cont" width="90%">редактируемый файл модифицирован (в статусной строке редактора присутствует символ '*')</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000010</td>
          <td class="cont" width="90%">в наличии есть выделенный поточный блок</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000020</td>
          <td class="cont" width="90%">в наличии есть выделенный вертикальный блок</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000040</td>
          <td class="cont" width="90%">редактируемый файл изменялся в сеансе редактирования</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000080</td>
          <td class="cont" width="90%">курсор в режиме замены</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000100</td>
          <td class="cont" width="90%">позиция курсора была изменена плагином</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000200</td>
          <td class="cont" width="90%">редактор заблокирован (ReadOnly)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000400</td>
          <td class="cont" width="90%">используются постоянные блоки</td>
        </tr>
      </table>
      Например,
      <pre class="code">
$If (Editor.State &amp; 0x8) <em>выполнить действия, если файл модифицирован</em> $End
</pre>
    </td>
  </tr>

  <tr class="cont"><th class="cont" colspan=3>Программа просмотра</th></tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Viewer.FileName">Viewer.FileName</a></td>
    <td class="cont" width="20%">String</td>
    <td class="cont" width="60%">полное имя просматриваемого файла</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Viewer.State">Viewer.State</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">различные состояния текущей программы просмотра -
      набор битовых флагов:
      <table class="cont">
        <tr class="cont">
          <th class="cont" width="10%">Значение</th>
          <th class="cont" width="90%">Описание</th>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000001</td>
          <td class="cont" width="90%">включено автоопределение таблицы символов</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000002</td>
          <td class="cont" width="90%">не используются таблицы символов и текст в
            кодировке ANSI</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000004</td>
          <td class="cont" width="90%">режим Unicode</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000008</td>
          <td class="cont" width="90%">включен перенос строк</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000010</td>
          <td class="cont" width="90%">используется перенос строк по словам, а не по
            буквам</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000020</td>
          <td class="cont" width="90%">выставлен 16-ричный режим</td>
        </tr>
      </table>
      Например,
      <pre class="code">
$If (Viewer.State &amp; 0x20) <em>выполнить действия, если выставлен 16-ричный режим</em> $End
</pre>
    </td>
  </tr>

  <tr class="cont"><th class="cont" colspan=3>Меню выбора дисков</th></tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Drv.ShowPos">Drv.ShowPos</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">для левой (AltF1, значение 1) или правой (AltF2, значение 2) панели вызвано меню выбора дисков.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Drv.ShowMode">Drv.ShowMode</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">флаги отображения меню выбора дисков; набор битовых флагов:
      <table class="cont">
        <tr class="cont">
          <th class="cont" width="10%">Значение</th>
          <th class="cont" width="90%">Описание</th>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000001</td>
          <td class="cont" width="90%">включен показ типа дисков</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000002</td>
          <td class="cont" width="90%">включен показ сетевого имени (и путь, ассоциированный с SUBST-диском под NT)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000004</td>
          <td class="cont" width="90%">включен показ метки диска</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000008</td>
          <td class="cont" width="90%">включен показ типа файловой системы</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000010</td>
          <td class="cont" width="90%">включен показ общего и свободного места на диске</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000020</td>
          <td class="cont" width="90%">включен показ параметров сменных дисков</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000040</td>
          <td class="cont" width="90%">включен показ имен подключаемых модулей</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000080</td>
          <td class="cont" width="90%">включен показ параметров компакт-дисков</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000100</td>
          <td class="cont" width="90%">включен показ общего и свободного места на диске в стиле Windows Explorer</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000200</td>
          <td class="cont" width="90%">включен показ параметров для сетевых дисков</td>
        </tr>
      </table>
    </td>
  </tr>

  <tr class="cont"><th class="cont" colspan=3>Прочее</th></tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="ItemCount">ItemCount</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">число элементов в текущем объекте; в меню разделительная черта тоже учитывается</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="CurPos">CurPos</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">позиция в текущем объекте</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Title">Title</a></td>
    <td class="cont" width="20%">String</td>
    <td class="cont" width="60%">заголовок текущего объекта</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Far.Width">Far.Width</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">ширина консоли, в которой работает FAR Manager</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Far.Height">Far.Height</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">высота консоли, в которой работает FAR Manager</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Far.Title">Far.Title</a></td>
    <td class="cont" width="20%">String</td>
    <td class="cont" width="60%">текущий заголовок консольного окна FAR</td>
  </tr>
</table>

<h3>Замечания</h3>
<div class=descr>
<ol>
<li>Элементы макроязыка невозможно использовать во время <a href="../macrokey/record.html">записи
    макроса</a> стандартным образом. Добавить элементы языка в макрос можно только путем ручной
    правки реестра или путем применения специальных программ/плагинов.</li>
</ol>
</div>

</body>

</html>
