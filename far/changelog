svs 12.12.2006 15:17:13 +0300 - build 2153

1. В FolderTree не отрабатывали мышиные правила для диалога (вне диалога).
   
2. Mantis#253 - Пропадание содержимого дерева папок
   [-] Пропадало содержимое дерева папок, если процесс перечитывания 
       каталогов прерывался.
   Добавил TreeList::SaveState() и TreeList::RestoreState(). чтобы сохранить
   текущие значения кеша и списка каталогов дерева.

3. DMOUSEBUTTON_* перенесены из dialog.hpp в farconst.hpp

svs 07.12.2006 15:25:47 +0300 - build 2152

1. Вводим VSMFL_REDRAW для ViewerSetMode.Flags, ибо так правильнее будет.
   т.е. либо VCTL_SETMODE + VCTL_REDRAW, либо VCTL_SETMODE(VSMFL_REDRAW).

svs 06.12.2006 19:30:17 +0300 - build 2151

1. Класс FolderTree наследуется от Frame, что позволило вылечить древний баг с 
   прорисовкой (F5 F10 F1 F5 F5 Esc - видим "грязь" на экране).
   Так же это изменение позволило добавить фичи:
   а) Alt-F9 (само получилось, т.к. Manager сам умеет перерисовывать все, что 
      наследуется от Frame)
   б) F5 - распахнуть/вернуть окно поиска каталога (по аналогии с хелпом)

   Так же, конструктор претерпел некоторые изменения в параметрах.

   В хелпах в раздел "@FindFolder" добавлена инфа про F5 и Ctrl[-Shift]-Enter.
   В FarEng.hlf.m4 нужен перевод.

2. Небольшие правки plugins.cpp. Просьба не употреблять __try/__except. Для
   этого есть макросы TRY/EXCEPT, соответственно.

3. Добавлен файл README. Перечислены некоторые правила. Если кто-то вспомнит
   еще правила - писать в этот файл.


warp & t-rex 05.12.2006 03:09:38 +0300 - build 2150

1. Поправлена логика предыдущего изменения. Кэшированные плагины не проверяются
   на принадлежность плагинам, это лишнее.

2. Функция проверки на принадлежность плагинам приведена в соответствие с x64.

warp 05.12.2006 01:39:38 +0300 - build 2149

1. Изменена логика загрузки плагинов. Введена проверка на принадлежность
   плагинам до загрузки модуля. Теперь Far будет ругаться на невозможность
   загрузить плагин, только если он был признан таковым до загрузки и при 
   этом LoadLibraryEx вернул _любую_ ошибку.

   [*] Изменена логика загрузки плагинов. Модуль проверяется на принадлежность
   плагинам до загрузки. 

2. Исправлен .pas файл на предмет VSMT_XXXX

svs 01.12.2006 19:47:38 +0300 - build 2148

1. Замена в составе: ViewerMode.TypeWrap -> ViewerMode.WordWrap

2. Добавка в ViewerAPI - VCTL_SETMODE, enum VIEWER_SETMODE_TYPES, struct ViewerSetMode

3. В XXXControl добавлена проверка на вшивость с юзанием IsBadReadPtr()


svs 30.11.2006 09:21:52 +0300 - build 2147

1. При выключенных настройках [ ] Save file position [ ] Save bookmarks 
   после открытия файла на редактирование курсор по умолчанию становится 
   в конец первой строки.

svs 28.11.2006 12:37:14 +0300 - build 2146

1. Mantis#248: Открытие по ShiftF4 предыдущего редактируемого файла.


t-rex 25.11.2006 10:53:30 +0200 - build 2145

1. Дополнение к x64. В PluginStartupInfo и FarStandardFunctions
   Reserved заменены с DWORD на DWORD_PTR чтоб не терять свой смысл.
   Соответственно это изменение требует пересборки x64 плагинов!

2. Немного GCC. Почему вы упорно не используете _i64(NUMBER) вместо NUMBERi64?
   И _ui64(NUMBER) вместо NUMBERui64.


svs 23.11.2006 19:51:42 +0300 - build 2144

1. Macro: $AKey - клавиша, который вызвали данный макрос
   (небольшой задел на будущее)

2. Возможность компиляции 1.7x под BCC


t-rex 23.11.2006 08:24:11 +0200 - build 2143

1. При удалении пустой строки или соединении двух строк при помощи DEL или BS выставлялись
   неправильные символы конца строки для "новой" строки.


t-rex 21.11.2006 18:13:55 +0200 - build 2142

1. Входим в эру 64-бит (ждём юникод :)

   Главные изменения: (надо будет обновить Енц.)
     DlgProc: long Param2 -> LONG_PTR Param2 и возвращает LONG_PTR вместо long
     SendDlgMessage: long Param2 -> LONG_PTR Param2 и возвращает LONG_PTR вместо long
     DefDlgProc: long Param2 -> LONG_PTR Param2 и возвращает LONG_PTR вместо long
     DialogEx: long Param -> LONG_PTR Param
     FarMenuItemEx: DWORD UserData -> DWORD_PTR UserData
     PluginPanelItem: DWORD UserData -> DWORD_PTR UserData
     AdvControl: возвращает INT_PTR вместо int
     OpenPlugin: int Item -> INT_PTR Item
   А также в execute.cpp добавлено определение 64-bit GUI прог.

   После некоторых экспериментов было выведено что выравнивание должно быть 8 для 64-bit версии.
   Обновил Far.mak и добавил vc.build.debug.64.bat и vc.build.release.64.bat которые используют
   custom.vc.debug.64.bat и custom.vc.release.64.bat соответственно.
   Мой custom.vc.release.64.bat содержит следующее:
   call "I:\Program Files\Microsoft Platform SDK for Windows Server 2003 R2\SetEnv.Cmd" /X64

   Единственное что ещё не доделано до конца это SEH - кто у нас в этом шарит?


svs 20.11.2006 16:37:26 +0300 - build 2141

1. Editor - copy/paste, блин.


t-rex 18.11.2006 23:23:58 +0200

1. без билда, обновил инклюды и скрипт генерации оных чтоб в них выводилась версия фара.


svs 17.11.2006 23:09:05 +0300 - build 2140

1. Бага предыдущего патча. В конце файла появлялся 0x00 
   при повторном открытии редактора.

2. Mantis#139 - Нарушения с концами строк при Отмене

3. + Edit::GetEOL()

4. У Editor::AddUndoData новый параметр - пусть Undo помнит EOL!

5. Небольшие правки в mkfar.mak


svs 16.11.2006 23:03:47 +0300 - build 2139

1. EditList удален. Next/Prev теперь принадлежать классу Edit

2. Однообразные куски кода по добавлению строки в редакторе 
   преобразованы в функции AddString и CreateString.

svs 13.11.2006 20:08:25 +0300 - build 2138

1. Добавлена функция FAR_GetFileSize (по аналогии с 1.80)

2. Wipe теперь "умеет" файлы > 2Gb

3. Заголовочные комменты в сорцах выносим в отдельный каталог.


svs 07.11.2006 21:33:42 +0300 -

1. без билда добавлен tee.exe с коррекцией vc.build.debug.bat и 
   vc.build.release.bat

warp 01.11.2006 02:56:09 +0300 - build 2137

1. Несколько ахтунговый фикс. До конца не проверил еще. 
   [-] Cтрока префиксов плагина больше не ограничена 512 символами. 

svs 10.10.2006 11:10:09 +0300 - build 2136

1. Macro: Area-коды разнесены. Теперь Condition имеет свои OpCode, а
   области - свои. Иначе в дампе макроса при логировании хрень.
   Для ньюсов ничего пистать ненадо.

svs 09.10.2006 12:08:32 +0300 - build 2135

1. Упоминание про Ctrl-Shift-Enter при быстром поиске (нужен перевод!)
   Mantis 244

2. FindFile: Зацикливается поиск при поиске подстроки на файле больше 2Gb
   Mantis 243

3. уточнение mkfar.mak - компиляция под BCC.


warp 05.10.2006 06:18:34 +0300 - build 2134

1. Вроде поправил ширину DIF_SEPARATOR для диалогов без рамки. 

t-rex 27.09.2006 04:05:23 +0300 - build 2133

1. Ещё одно дополнение к фиксу "Падение при старте ФАРа, когда каталог недоступен".
   На пассивной панели открывался каталог без ".." вверху.

t-rex 27.09.2006 03:07:27 +0300

Косметика без билда.

1. Прошлый патч был совсем не в тему. Вернул как было и чтоб больше не было
   вопросов сделал два батника и изменил Far.mak:

   Эти батники на прямую не редактировать!!!!!!!!!
   Только для постоянных изменений для всех участников проекта.
   Читайте объяснение - всё продумано.

   --------------------
   vc.build.release.bat
   --------------------
   Этот батник собирает release версию фара с помощью VC и Far.mak.
   Батник заодно обновляет far.release.dep и языковые файлы.
   С запуском этого батника никогда не будут никаких проблем при сборке фара
   (кроме ошибок в самом коде :).
   Чтобы батник был универсальным и работал у всех без изменений он
   вызывает другой батник - custom.vc.release.bat - если такой есть.
   Этот (custom.vc.release.bat) батник вам надо создать самим так как он ваш
   личный и на SVN комитится не будет. В нём вы можете определять переменные
   среды компайлера и переопределять переменные среды которые используются
   для сборки фара в главном батнике.
   Например у меня он содержит:
   ---->8----
   @echo off
   call F:\lng\VC.Toolkit.2003\vcvars32.bat
   ----8<----
 
   ------------------
   vc.build.debug.bat
   ------------------
   Тоже что и vc.build.release.bat только собирает debug версию, обновляет
   far.debug.dep и вызывает custom.vc.debug.bat если такой есть.
   Пример custom.vc.debug.bat:
   ---->8----
   @echo off
   call F:\lng\VS98\Bin\VCVARS32.BAT
   set FAR_MSVCRT=/D FAR_MSVCRT
   set FARSYSLOG=-DSYSLOG_TREX %FARSYSLOG%
   ----8<----


svs 26.09.2006 10:52:00 +0300 -

Косметика без билда.

1. В mkdep.list.txt добавлены copyright.inc и farversion.inc, т.к. если сделать
   первый раз экспорт, а потом запустить компиляцию, то будет ошибка компиляции
   global.cpp, т.к.  ни copyright.inc ни farversion.inc еще нету.
   
   Так же исправлен scripts\mkdep.awk - учитывает расширение INC, т.е. как раз 
   те самые файлы copyright.inc и farversion.inc, которые генерятся из *.m4.


t-rex 24.09.2006 17:21:44 +0300 - build 2132

1. Не влезали русские слова в диалог фильтра.

t-rex 23.09.2006 04:19:12 +0300 - build 2131

1. Дополнил Валин фикс на тему "Падение при старте ФАРа, когда каталог недоступен"
   а то выходила фигня если недоступный путь был например C:\a - фар открывал C: и
   делал это очень криво.

t-rex 23.09.2006 02:54:44 +0300 - build 2130

1. Починил вставку мусора в редакторе в висте при нажатие на Enter.
   В висте realloc на уменьшение не всегда (а может и никогда) ни возвращает тот же адрес.

2. Починил сборку GCC.

t-rex 23.09.2006 01:12:39 +0300 - build 2129

1. Новая система сборки как и в 1.80 для работы с SVN.

2. Начинаем писать changelog, я сделал себе макрос
   "t - r e x Space $Date \"%d.%m0.%Y %H:%M:%S %Z\" Enter"
   чтоб выводить заголовок changelog-а.
   Последующие логи надо писать сверху - т.е. файл будет идти хронологически снизу вверх.
   В changelog прошу писать в Win кодировке.
